<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="By 19083" />


<title>homework</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">By 19083</h4>
<h4 class="date">2020/1/2</h4>



<div id="hw-1how-to-use-rstudio" class="section level2">
<h2>HW-1:How to use Rstudio?</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(xtable)</a>
<a class="sourceLine" id="cb1-2" title="2">x&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1-3" title="3">y&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">x1&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">4</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>,<span class="dt">dimnames=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>),<span class="kw">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>)))</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">print</span>(<span class="kw">xtable</span>(x1),<span class="dt">type=</span><span class="st">&quot;html&quot;</span>)</a></code></pre></div>
<pre><code>## &lt;!-- html table generated in R 3.6.1 by xtable 1.8-4 package --&gt;
## &lt;!-- Thu Jan 02 14:22:21 2020 --&gt;
## &lt;table border=1&gt;
## &lt;tr&gt; &lt;th&gt;  &lt;/th&gt; &lt;th&gt; 1 &lt;/th&gt; &lt;th&gt; 2 &lt;/th&gt; &lt;th&gt; 3 &lt;/th&gt; &lt;th&gt; 4 &lt;/th&gt;  &lt;/tr&gt;
##   &lt;tr&gt; &lt;td align=&quot;right&quot;&gt; x &lt;/td&gt; &lt;td align=&quot;right&quot;&gt; 1.00 &lt;/td&gt; &lt;td align=&quot;right&quot;&gt; 2.00 &lt;/td&gt; &lt;td align=&quot;right&quot;&gt; 3.00 &lt;/td&gt; &lt;td align=&quot;right&quot;&gt; 4.00 &lt;/td&gt; &lt;/tr&gt;
##   &lt;tr&gt; &lt;td align=&quot;right&quot;&gt; y &lt;/td&gt; &lt;td align=&quot;right&quot;&gt; 1.00 &lt;/td&gt; &lt;td align=&quot;right&quot;&gt; 2.00 &lt;/td&gt; &lt;td align=&quot;right&quot;&gt; 3.00 &lt;/td&gt; &lt;td align=&quot;right&quot;&gt; 4.00 &lt;/td&gt; &lt;/tr&gt;
##    &lt;/table&gt;</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">x&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">y&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">plot</span>(x,y)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">x&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">y&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb4-3" title="3">x1&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">4</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>,<span class="dt">dimnames=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>),<span class="kw">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>)))</a>
<a class="sourceLine" id="cb4-4" title="4">knitr<span class="op">::</span><span class="kw">kable</span>(x1,<span class="dt">format=</span><span class="st">&quot;markdown&quot;</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">y</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">plot</span>(x,y,<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(cars),<span class="dt">format=</span><span class="st">&quot;markdown&quot;</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">speed</th>
<th align="right">dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">plot</span>(<span class="kw">head</span>(cars),<span class="dt">type=</span><span class="st">&quot;p&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">main=</span><span class="st">&quot;cars&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="hw-2" class="section level2">
<h2>HW-2:</h2>
<div id="exersise-3.4" class="section level3">
<h3>Exersise 3.4</h3>
<span class="math display">\[\begin{array}{l}{\text { 3.4 The Rayleigh density }[156, \text { Ch. } 18] \text { is }} \\ {\qquad f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}, \quad x \geq 0, \sigma&gt;0} \\ {\text { Develop an algorithm to generate random samples from a Rayleigh }(\sigma) \text { distri- }} \\ {\text { bution. Generate Rayleigh }(\sigma) \text { samples for several choices of } \sigma&gt;0 \text { and check }} \\ {\text { that the mode of the generated samples is close to the theoretical mode } \sigma} \\ {\text { (check the histogram). }}\end{array}\]</span>
</div>
<div id="σ0.5" class="section level3">
<h3>σ=0.5</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb8-2" title="2">sigma&lt;-<span class="fl">0.5</span><span class="co">#给σ赋值</span></a>
<a class="sourceLine" id="cb8-3" title="3">u&lt;-<span class="kw">runif</span>(n)<span class="co">#F(x)服从(0,1)上的均匀分布</span></a>
<a class="sourceLine" id="cb8-4" title="4">x&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u,<span class="dt">base=</span><span class="kw">exp</span>(<span class="dv">1</span>)))<span class="co">#对x取样</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">25</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>(x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>e<span class="op">^</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))<span class="co">#画x的直方图</span></a>
<a class="sourceLine" id="cb8-6" title="6">y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb8-7" title="7"><span class="kw">lines</span>(y,(y<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))<span class="co">#画密度函数图像</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="σ1" class="section level3">
<h3>σ=1</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb9-2" title="2">sigma&lt;-<span class="dv">1</span><span class="co">#给σ赋值</span></a>
<a class="sourceLine" id="cb9-3" title="3">u&lt;-<span class="kw">runif</span>(n)<span class="co">#F(x)服从(0,1)上的均匀分布</span></a>
<a class="sourceLine" id="cb9-4" title="4">x&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u,<span class="dt">base=</span><span class="kw">exp</span>(<span class="dv">1</span>)))<span class="co">#对x取样</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">25</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>(x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>e<span class="op">^</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))<span class="co">#画x的直方图</span></a>
<a class="sourceLine" id="cb9-6" title="6">y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb9-7" title="7"><span class="kw">lines</span>(y,(y<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))<span class="co">#画密度函数图像</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="σ1.2" class="section level3">
<h3>σ=1.2</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb10-2" title="2">sigma&lt;-<span class="fl">1.2</span><span class="co">#给σ赋值</span></a>
<a class="sourceLine" id="cb10-3" title="3">u&lt;-<span class="kw">runif</span>(n)<span class="co">#F(x)服从(0,1)上的均匀分布</span></a>
<a class="sourceLine" id="cb10-4" title="4">x&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u,<span class="dt">base=</span><span class="kw">exp</span>(<span class="dv">1</span>)))<span class="co">#对x取样</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">25</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>(x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>e<span class="op">^</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))<span class="co">#画x的直方图</span></a>
<a class="sourceLine" id="cb10-6" title="6">y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">6</span>,<span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb10-7" title="7"><span class="kw">lines</span>(y,(y<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))<span class="co">#画密度函数图像</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<div id="from-the-figureswe-can-find-that-the-lines-fits-well-with-the-top-of-the-histogramwhich-means-the-mode-of-the-generated-samples-is-close-to-the-theoretical-mode-σ.so-the-inverse-transform-method-is-a-good-way-to-generate-rayleighσ-samples.howeverthere-are-still-some-cells-on-or-under-lines.that-means-our-method-can-get-improved." class="section level4">
<h4>From the figures,we can find that the lines fits well with the top of the histogram,which means the mode of the generated samples is close to the theoretical mode σ.So the inverse transform method is a good way to generate Rayleigh(σ) samples.However,there are still some cells on or under lines.That means our method can get improved.</h4>
</div>
</div>
<div id="exercise-3.11" class="section level3">
<h3>Exercise 3.11</h3>
<p><span class="math display">\[\begin{equation}
\begin{array}{l}{\text { Generate a random sample of size } 1000 \text { from a normal location mixture. The }} \\ {\text { components of the mixture have } N(0,1) \text { and } N(3,1) \text { distributions with mixing }} \\ {\text { probabilities } p_{1} \text { and } p_{2}=1-p_{1} \text { . Graph the histogram of the sample with }} \\ {\text { density superimposed, for } p_{1}=0.75 . \text { Repeat with different values for } p_{1}} \\ {\text { and observe whether the empirical distribution of the mixture appears to be }} \\ {\text { bimodal. Make a conjecture about the values of } p_{1} \text { that produce bimodal }} \\ {\text { mixtures. }}\end{array}
\end{equation}\]</span></p>
</div>
<div id="p10.75p20.25" class="section level3">
<h3>p1=0.75,p2=0.25</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">n&lt;-<span class="dv">1000</span><span class="co">#样本容量</span></a>
<a class="sourceLine" id="cb11-2" title="2">p&lt;-<span class="kw">c</span>(<span class="fl">0.25</span>,<span class="fl">0.75</span>)<span class="co">#p1=0.75</span></a>
<a class="sourceLine" id="cb11-3" title="3">x1&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)<span class="co">#对x1，x2取样</span></a>
<a class="sourceLine" id="cb11-4" title="4">x2&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">3</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-5" title="5">r&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">prob=</span>p,<span class="dt">replace=</span><span class="ot">TRUE</span>)<span class="co">#对混合概率取样</span></a>
<a class="sourceLine" id="cb11-6" title="6">z&lt;-r<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>x2<span class="co">#混合分布</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="kw">hist</span>(z,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">50</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="fl">0.75</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">+</span><span class="fl">0.25</span><span class="op">*</span>x[<span class="dv">2</span>]))<span class="co">#画直方图</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="kw">lines</span>(<span class="kw">density</span>(z))<span class="co">#画密度图像</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="p10.7p20.3" class="section level3">
<h3>p1=0.7,p2=0.3</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb12-2" title="2">p&lt;-<span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>)<span class="co">#p1=0.7</span></a>
<a class="sourceLine" id="cb12-3" title="3">x1&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-4" title="4">x2&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">3</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-5" title="5">r&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">prob=</span>p,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-6" title="6">z&lt;-r<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb12-7" title="7"><span class="kw">hist</span>(z,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">50</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="fl">0.7</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">+</span><span class="fl">0.3</span><span class="op">*</span>x[<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb12-8" title="8"><span class="kw">lines</span>(<span class="kw">density</span>(z))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="p10.6p20.4" class="section level3">
<h3>p1=0.6,p2=0.4</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb13-2" title="2">p&lt;-<span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.6</span>)<span class="co">#p1=0.6</span></a>
<a class="sourceLine" id="cb13-3" title="3">x1&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-4" title="4">x2&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">3</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-5" title="5">r&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">prob=</span>p,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb13-6" title="6">z&lt;-r<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb13-7" title="7"><span class="kw">hist</span>(z,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">50</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="fl">0.6</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">+</span><span class="fl">0.4</span><span class="op">*</span>x[<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb13-8" title="8"><span class="kw">lines</span>(<span class="kw">density</span>(z))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="p10.5p20.5" class="section level3">
<h3>p1=0.5,p2=0.5</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb14-2" title="2">p&lt;-<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>)<span class="co">#p1=0.5</span></a>
<a class="sourceLine" id="cb14-3" title="3">x1&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-4" title="4">x2&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">3</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-5" title="5">r&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">prob=</span>p,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-6" title="6">z&lt;-r<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb14-7" title="7"><span class="kw">hist</span>(z,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">50</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="fl">0.5</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">+</span><span class="fl">0.5</span><span class="op">*</span>x[<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb14-8" title="8"><span class="kw">lines</span>(<span class="kw">density</span>(z))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="p10.4p20.6" class="section level3">
<h3>p1=0.4,p2=0.6</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb15-2" title="2">p&lt;-<span class="kw">c</span>(<span class="fl">0.6</span>,<span class="fl">0.4</span>)<span class="co">#p1=0.4</span></a>
<a class="sourceLine" id="cb15-3" title="3">x1&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-4" title="4">x2&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">3</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-5" title="5">r&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">prob=</span>p,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-6" title="6">z&lt;-r<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb15-7" title="7"><span class="kw">hist</span>(z,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">50</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="fl">0.4</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">+</span><span class="fl">0.6</span><span class="op">*</span>x[<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb15-8" title="8"><span class="kw">lines</span>(<span class="kw">density</span>(z))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="discussion-1" class="section level3">
<h3>Discussion</h3>
<div id="from-the-figureswe-can-find-that-the-closer-the-p1-is-to-0.5the-more-obviously-the-empirical-distribution-of-the-mixture-appears-to-be-bimodal.due-to-space-constraintswe-did-not-draw-many-figures-with-different-mixing-probabilities.so-the-data-support-of-our-conclutions-might-be-not-enough." class="section level4">
<h4>From the figures,we can find that the closer the p1 is to 0.5,the more obviously the empirical distribution of the mixture appears to be bimodal.Due to space constraints,we did not draw many figures with different mixing probabilities.So the data support of our conclutions might be not enough.</h4>
</div>
</div>
<div id="exercise-3.18" class="section level3">
<h3>Exercise 3.18</h3>
<p><span class="math display">\[\begin{equation}
\begin{array}{l}{\text { Write a function to generate a random sample from a } W_{d}(\Sigma, n) \text { (Wishart) }} \\ {\text { distribution for } n&gt;d+1 \geq 1 \text { , based on Bartlett&#39;s decomposition. }}\end{array}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">sample.Wishart&lt;-<span class="cf">function</span>(sigma,nf,d,N){</a>
<a class="sourceLine" id="cb16-2" title="2">  <span class="co">#根据Bartlett分解对Wishart分布进行取样的函数</span></a>
<a class="sourceLine" id="cb16-3" title="3">  <span class="co">#Σ是Wishart分布的协方差矩阵</span></a>
<a class="sourceLine" id="cb16-4" title="4">  <span class="co">#nf是Wishart分布的自由度</span></a>
<a class="sourceLine" id="cb16-5" title="5">  <span class="co">#d是正态分布的维度</span></a>
<a class="sourceLine" id="cb16-6" title="6">  <span class="co">#N是样本容量</span></a>
<a class="sourceLine" id="cb16-7" title="7">  L&lt;-<span class="kw">chol</span>(sigma)<span class="co"># 计算Σ的Cholesky矩阵</span></a>
<a class="sourceLine" id="cb16-8" title="8">  n&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb16-9" title="9">  X&lt;-<span class="kw">as.list</span>(<span class="kw">numeric</span>(N))</a>
<a class="sourceLine" id="cb16-10" title="10">  <span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb16-11" title="11">    <span class="co">#对Wishart分布取样N次</span></a>
<a class="sourceLine" id="cb16-12" title="12">    i&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb16-13" title="13">    A&lt;-<span class="kw">matrix</span>(<span class="kw">numeric</span>(d<span class="op">^</span><span class="dv">2</span>),<span class="dt">nrow=</span>d)</a>
<a class="sourceLine" id="cb16-14" title="14">    c2&lt;-<span class="kw">numeric</span>(d)</a>
<a class="sourceLine" id="cb16-15" title="15">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){</a>
<a class="sourceLine" id="cb16-16" title="16">      <span class="co">#对A矩阵对角元取样</span></a>
<a class="sourceLine" id="cb16-17" title="17">      c2[i]&lt;-<span class="kw">rchisq</span>(<span class="dt">n=</span><span class="dv">1</span>,<span class="dt">df=</span>nf<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb16-18" title="18">      A[i,i]&lt;-<span class="kw">sqrt</span>(c2[i])</a>
<a class="sourceLine" id="cb16-19" title="19">    }</a>
<a class="sourceLine" id="cb16-20" title="20">    A</a>
<a class="sourceLine" id="cb16-21" title="21">    i&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb16-22" title="22">    j&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb16-23" title="23">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){</a>
<a class="sourceLine" id="cb16-24" title="24">      <span class="co">#对A其他元素取样</span></a>
<a class="sourceLine" id="cb16-25" title="25">      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i){</a>
<a class="sourceLine" id="cb16-26" title="26">      A[i,j]<span class="op">&lt;</span><span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb16-27" title="27">      }</a>
<a class="sourceLine" id="cb16-28" title="28">    }</a>
<a class="sourceLine" id="cb16-29" title="29">    X[[n]]&lt;-L<span class="op">%*%</span>A<span class="op">%*%</span><span class="kw">t</span>(L)<span class="op">%*%</span><span class="kw">t</span>(A)<span class="co">#得到一个Wishart分布样本</span></a>
<a class="sourceLine" id="cb16-30" title="30">  }</a>
<a class="sourceLine" id="cb16-31" title="31">  <span class="kw">return</span>(X)<span class="co">#返回取样结果</span></a>
<a class="sourceLine" id="cb16-32" title="32">}</a>
<a class="sourceLine" id="cb16-33" title="33"><span class="co">#试运行Wishart取样函数</span></a>
<a class="sourceLine" id="cb16-34" title="34">si&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>)<span class="co">#任取3X3矩阵</span></a>
<a class="sourceLine" id="cb16-35" title="35">sig&lt;-si<span class="op">%*%</span><span class="kw">t</span>(si)<span class="co">#保证Σ是对称正定矩阵</span></a>
<a class="sourceLine" id="cb16-36" title="36"><span class="co">#取自由度为5，维度为3，样本容量为5</span></a>
<a class="sourceLine" id="cb16-37" title="37">n&lt;-<span class="dv">5</span></a>
<a class="sourceLine" id="cb16-38" title="38">d&lt;-<span class="dv">3</span></a>
<a class="sourceLine" id="cb16-39" title="39">N&lt;-<span class="dv">5</span></a>
<a class="sourceLine" id="cb16-40" title="40">X&lt;-<span class="kw">sample.Wishart</span>(<span class="dt">sigma=</span>sig,<span class="dt">nf=</span>n,<span class="dt">d=</span>d,<span class="dt">N=</span>N)<span class="co">#用Wishart取样函数取样</span></a>
<a class="sourceLine" id="cb16-41" title="41">X</a></code></pre></div>
<pre><code>## [[1]]
##           [,1]      [,2]      [,3]
## [1,] 325.48645 16.487345 1.3153657
## [2,]  40.46598  9.906214 1.0318577
## [3,]  10.02943  3.205605 0.7721716
## 
## [[2]]
##           [,1]     [,2]     [,3]
## [1,] 180.49441 37.21199 7.431878
## [2,]  44.28422 23.75155 5.830045
## [3,]  15.49465 10.21384 4.362806
## 
## [[3]]
##           [,1]     [,2]     [,3]
## [1,] 136.75525 47.08360 6.533014
## [2,]  38.63283 29.31061 5.124918
## [3,]  11.85844 11.33742 3.835137
## 
## [[4]]
##          [,1]      [,2]      [,3]
## [1,] 63.63790 22.828365 13.545191
## [2,] 22.47418 15.725354 10.625722
## [3,] 10.96143  8.734367  7.951562
## 
## [[5]]
##           [,1]     [,2]     [,3]
## [1,] 117.54862 15.22724 31.10191
## [2,]  38.94799 11.25228 24.39835
## [3,]  24.31521  7.45740 18.25805</code></pre>
</div>
<div id="discussion-2" class="section level3">
<h3>Discussion</h3>
<div id="our-method-has-been-finished.howeverwe-do-not-know-how-to-evaluate-our-function.does-our-function-generate-good-samplesdo-these-samples-obey-wishart-distributionare-there-any-other-methods-to-generate-samples-from-wishart-distributionthese-are-what-we-are-interested-in-after-the-function-finished." class="section level4">
<h4>Our method has been finished.However,we do not know how to evaluate our function.Does our function generate good samples?Do these samples obey Wishart distribution?Are there any other methods to generate samples from Wishart distribution?These are what we are interested in after the function finished.</h4>
</div>
</div>
</div>
<div id="hw-3" class="section level2">
<h2>HW-3:</h2>
<div id="section" class="section level4">
<h4><span class="math display">\[\begin{equation}
\begin{array}{l}{\text { Compute a Monte Carlo estimate of }} \\ {\qquad \int_{0}^{\pi / 3} \sin t d t} \\ {\text { and compare your estimate with the exact value of the integral. }}\end{array}
\end{equation}\]</span></h4>
</div>
<div id="k10m10000" class="section level3">
<h3>k=10,M=10000</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">M&lt;-<span class="dv">10000</span><span class="co">#总样本容量</span></a>
<a class="sourceLine" id="cb18-2" title="2">k&lt;-<span class="dv">10</span><span class="co">#分层数</span></a>
<a class="sourceLine" id="cb18-3" title="3">r&lt;-M<span class="op">/</span>k<span class="co">#每层取样数</span></a>
<a class="sourceLine" id="cb18-4" title="4">N&lt;-<span class="dv">50</span><span class="co">#重复估计的次数</span></a>
<a class="sourceLine" id="cb18-5" title="5">T&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb18-6" title="6">est&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb18-7" title="7">g&lt;-<span class="cf">function</span>(x)<span class="kw">sin</span>(x)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span>(pi<span class="op">/</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb18-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb18-9" title="9">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)T[j]&lt;-<span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(r,(j<span class="dv">-1</span>)<span class="op">*</span>pi<span class="op">/</span>(k<span class="op">*</span><span class="dv">3</span>),j<span class="op">*</span>pi<span class="op">/</span>(k<span class="op">*</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb18-10" title="10">  est[i]&lt;-<span class="kw">mean</span>(T)</a>
<a class="sourceLine" id="cb18-11" title="11">}</a>
<a class="sourceLine" id="cb18-12" title="12">mean&lt;-<span class="kw">mean</span>(est)</a>
<a class="sourceLine" id="cb18-13" title="13">s&lt;-<span class="kw">sd</span>(est)</a>
<a class="sourceLine" id="cb18-14" title="14">mean</a></code></pre></div>
<pre><code>## [1] 0.4774575</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">s</a></code></pre></div>
<pre><code>## [1] 0.0002425035</code></pre>
</div>
<div id="k100m100000" class="section level3">
<h3>k=100,M=100000</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">M&lt;-<span class="dv">100000</span><span class="co">#总样本容量</span></a>
<a class="sourceLine" id="cb22-2" title="2">k&lt;-<span class="dv">100</span><span class="co">#分层数</span></a>
<a class="sourceLine" id="cb22-3" title="3">r&lt;-M<span class="op">/</span>k<span class="co">#每层取样数</span></a>
<a class="sourceLine" id="cb22-4" title="4">N&lt;-<span class="dv">50</span><span class="co">#重复估计的次数</span></a>
<a class="sourceLine" id="cb22-5" title="5">T&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb22-6" title="6">est&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb22-7" title="7">g&lt;-<span class="cf">function</span>(x)<span class="kw">sin</span>(x)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span>(pi<span class="op">/</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb22-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb22-9" title="9">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)T[j]&lt;-<span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(r,(j<span class="dv">-1</span>)<span class="op">*</span>pi<span class="op">/</span>(k<span class="op">*</span><span class="dv">3</span>),j<span class="op">*</span>pi<span class="op">/</span>(k<span class="op">*</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb22-10" title="10">  est[i]&lt;-<span class="kw">mean</span>(T)</a>
<a class="sourceLine" id="cb22-11" title="11">}</a>
<a class="sourceLine" id="cb22-12" title="12">mean&lt;-<span class="kw">mean</span>(est)</a>
<a class="sourceLine" id="cb22-13" title="13">s&lt;-<span class="kw">sd</span>(est)</a>
<a class="sourceLine" id="cb22-14" title="14">mean</a></code></pre></div>
<pre><code>## [1] 0.4774644</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">s</a></code></pre></div>
<pre><code>## [1] 7.686486e-06</code></pre>
</div>
<div id="discussionafter-calculation-we-know-that-the-accurate-value-of-the-integral-is-0.5.-the-result-obtained-by-the-stratified-sampling-method-is-close-to-0.5-and-the-variance-is-small-enough.-we-choose-the-larger-k-and-m-and-find-that-we-can-only-reduce-the-variance-not-make-the-mean-value-closer-to-0.5." class="section level3">
<h3>Discussion:After calculation, we know that the accurate value of the integral is 0.5. The result obtained by the Stratified sampling method is close to 0.5, and the variance is small enough. We choose the larger K and M, and find that we can only reduce the variance, not make the mean value closer to 0.5.</h3>
</div>
<div id="section-1" class="section level3">
<h3><span class="math display">\[\begin{equation}
\begin{array}{l}{\text { Use Monte Carlo integration with antithetic variables to estimate }} \\ {\qquad \int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x} \\ {\text { and find the approximate reduction in variance as a percentage of the variance }} \\ {\text { without variance reduction. }}\end{array}
\end{equation}\]</span></h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">k&lt;-<span class="dv">100</span><span class="co">#普通蒙特卡洛估计的样本容量</span></a>
<a class="sourceLine" id="cb26-2" title="2">N&lt;-<span class="dv">50</span><span class="co">#重复估计的次数</span></a>
<a class="sourceLine" id="cb26-3" title="3">T1&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb26-4" title="4">T2&lt;-<span class="kw">numeric</span>(k<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-5" title="5">est&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-6" title="6">g1&lt;-<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)<span class="co">#普通蒙特卡洛估计</span></a>
<a class="sourceLine" id="cb26-7" title="7">g2&lt;-<span class="cf">function</span>(x)(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">exp</span>(<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>x))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)<span class="co">#对偶变量蒙特卡洛估计</span></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb26-9" title="9">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)T1[j]&lt;-<span class="kw">g1</span>(<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb26-10" title="10">  est[i,<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(T1)</a>
<a class="sourceLine" id="cb26-11" title="11">  <span class="cf">for</span>(a <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(k<span class="op">/</span><span class="dv">2</span>))T2[a]&lt;-<span class="kw">g2</span>(<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb26-12" title="12">  est[i,<span class="dv">2</span>]&lt;-<span class="kw">sum</span>(T2)<span class="op">/</span>k</a>
<a class="sourceLine" id="cb26-13" title="13">}</a>
<a class="sourceLine" id="cb26-14" title="14"><span class="kw">c</span>(<span class="kw">sd</span>(est[,<span class="dv">1</span>]),<span class="kw">sd</span>(est[,<span class="dv">2</span>]),<span class="kw">sd</span>(est[,<span class="dv">2</span>])<span class="op">/</span><span class="kw">sd</span>(est[,<span class="dv">1</span>]))</a></code></pre></div>
<pre><code>## [1] 0.026943887 0.004564497 0.169407529</code></pre>
</div>
<div id="discussionit-can-be-seen-that-the-variance-of-the-results-obtained-by-the-antithetic-variables-method-is-0.169-times-of-the-original-method.-the-results-show-that-the-antigenic-variables-method-can-effectively-reduce-the-variance." class="section level3">
<h3>Discussion:It can be seen that the variance of the results obtained by the antithetic variables method is 0.169 times of the original method. The results show that the antigenic variables method can effectively reduce the variance.</h3>
</div>
<div id="section-2" class="section level3">
<h3><span class="math display">\[\begin{equation}
\begin{array}{l}{\text { Obtain the stratified importance sampling estimate in Example } 5.13 \text { and com- }} \\ {\text { pare it with the result of Example } 5.10 \text { . }}\end{array}
\end{equation}\]</span></h3>
</div>
<div id="section-3" class="section level3">
<h3><span class="math display">\[\begin{equation}
\begin{array}{l}{\text { Example } 5.13 \text { (Example } 5.10, \text { cont.) }} \\ {\text { In Example } 5.10 \text { our best result was obtained with importance function } f_{3}(x)=} \\ {e^{-x} /\left(1-e^{-1}\right), 0&lt;x&lt;1 . \text { From } 10000 \text { replicates we obtained the estimate }} \\ {\hat{\theta}=0.5257801 \text { and an estimated standard error } 0.0970314 \text { . Now divide the }} \\ {\text { interval }(0,1) \text { into five subintervals, }(j / 5,(j+1) / 5), j=0,1, \ldots, 4 \text { . }} \\ {\text { Then on the } j^{t h} \text { subinterval variables are generated from the density }} \\ {\qquad \frac{5 e^{-x}}{1-e^{-1}}, \quad \frac{j-1}{5}&lt;x&lt;\frac{j}{5} .} \\ {\text { The implementation is left as an exercise. }}\end{array}
\end{equation}\]</span></h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">p&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb28-2" title="2">q&lt;-<span class="kw">numeric</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb28-3" title="3"><span class="cf">for</span>(a <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>){</a>
<a class="sourceLine" id="cb28-4" title="4">  <span class="co">#求f(x)5分位点</span></a>
<a class="sourceLine" id="cb28-5" title="5">  q[a]&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>p[a]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb28-6" title="6">}</a>
<a class="sourceLine" id="cb28-7" title="7">M&lt;-<span class="dv">100</span><span class="co">#总样本容量</span></a>
<a class="sourceLine" id="cb28-8" title="8">k&lt;-<span class="dv">5</span><span class="co">#分层数</span></a>
<a class="sourceLine" id="cb28-9" title="9">r&lt;-M<span class="op">/</span>k<span class="co">#每层取样数</span></a>
<a class="sourceLine" id="cb28-10" title="10">N&lt;-<span class="dv">50</span><span class="co">#重复估计的次数</span></a>
<a class="sourceLine" id="cb28-11" title="11">T&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb28-12" title="12">est&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb28-13" title="13"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb28-14" title="14">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb28-15" title="15">    u&lt;-<span class="kw">runif</span>(r)<span class="co">#f3, inverse transform method</span></a>
<a class="sourceLine" id="cb28-16" title="16">    x&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>q[j])<span class="op">-</span>u<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb28-17" title="17">    gq&lt;-<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb28-18" title="18">    fq&lt;-<span class="cf">function</span>(x)(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb28-19" title="19">    fg&lt;-<span class="kw">gq</span>(x)<span class="op">/</span>(<span class="dv">5</span><span class="op">*</span><span class="kw">fq</span>(x))</a>
<a class="sourceLine" id="cb28-20" title="20">    T[j]&lt;-<span class="kw">mean</span>(fg)<span class="co">#计算每个区间的积分估计值</span></a>
<a class="sourceLine" id="cb28-21" title="21">  }</a>
<a class="sourceLine" id="cb28-22" title="22">  est[i]&lt;-<span class="kw">sum</span>(T)<span class="co">#对所有区间求和，得到整个区间的积分估计值</span></a>
<a class="sourceLine" id="cb28-23" title="23">}</a>
<a class="sourceLine" id="cb28-24" title="24"><span class="kw">mean</span>(est)</a></code></pre></div>
<pre><code>## [1] 0.5243363</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">sd</span>(est)</a></code></pre></div>
<pre><code>## [1] 0.001712083</code></pre>
</div>
<div id="discussionthe-mean-value-of-si-method-is-basically-the-same-as-that-of-example-5.10-but-the-variance-is-much-smaller-than-that-of-example-5.10.-it-shows-that-stratified-sampling-can-significantly-reduce-variance." class="section level3">
<h3>Discussion:The mean value of SI method is basically the same as that of example 5.10, but the variance is much smaller than that of example 5.10. It shows that stratified sampling can significantly reduce variance.</h3>
</div>
</div>
<div id="hw-4" class="section level2">
<h2>HW-4:</h2>
<div id="suppose-a-95-symmetric-t--interval-is-applied-to-estimate-a-mean-but-the-sample-data-are-non-normal.-then-the-probability-the-confidence-interval-covers-the-mean-is-not-necessarily-equal-to-0.95-.-use-a-monte-carlo-experiment-to-estimate-the-coverage-probability-of-the-t--interval-for-random-samples-of-chi22-data-with-sample-size-n20-.-compare-your-t--interval-results-with-the-simulation-results-in-example-6.4.-the-t--interval-should-be-more-robust-to-departures-from-normality-than-the-interval-for-variance." class="section level4">
<h4>Suppose a <span class="math inline">\(95 \%\)</span> symmetric <span class="math inline">\(t\)</span> -interval is applied to estimate a mean, but the sample data are non-normal. Then the probability the confidence interval covers the mean is not necessarily equal to <span class="math inline">\(0.95 .\)</span> Use a Monte Carlo experiment to estimate the coverage probability of the <span class="math inline">\(t\)</span> -interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size <span class="math inline">\(n=20 .\)</span> Compare your <span class="math inline">\(t\)</span> -interval results with the simulation results in Example 6.4. (The <span class="math inline">\(t\)</span> -interval should be more robust to departures from normality than the interval for variance.</h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">m&lt;-<span class="dv">1000</span><span class="co">#Monte Carlo estimation times</span></a>
<a class="sourceLine" id="cb32-2" title="2">n&lt;-<span class="dv">20</span><span class="co">#sample size</span></a>
<a class="sourceLine" id="cb32-3" title="3">up&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb32-4" title="4">down&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb32-5" title="5">mean&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb32-6" title="6">s&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb32-7" title="7">t&lt;-<span class="kw">qt</span>(<span class="fl">0.975</span>,<span class="dt">df=</span>(n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb32-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb32-9" title="9">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb32-10" title="10">  mean[i]&lt;-<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb32-11" title="11">  s[i]&lt;-<span class="kw">var</span>(x)</a>
<a class="sourceLine" id="cb32-12" title="12">  up[i]&lt;-(mean[i]<span class="op">+</span>t<span class="op">*</span>s[i]<span class="op">/</span><span class="kw">sqrt</span>(n))<span class="co">#up line of CI</span></a>
<a class="sourceLine" id="cb32-13" title="13">  down[i]&lt;-(mean[i]<span class="op">-</span>t<span class="op">*</span>s[i]<span class="op">/</span><span class="kw">sqrt</span>(n))<span class="co">#down line of CI</span></a>
<a class="sourceLine" id="cb32-14" title="14">}</a>
<a class="sourceLine" id="cb32-15" title="15">p&lt;-<span class="kw">mean</span>(up<span class="op">&gt;</span><span class="dv">2</span><span class="op">&amp;</span>down<span class="op">&lt;</span><span class="dv">2</span>)<span class="co">#compute the mean to get the confidence level</span></a>
<a class="sourceLine" id="cb32-16" title="16">p</a></code></pre></div>
<pre><code>## [1] 0.943</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">se&lt;-<span class="kw">sqrt</span>((<span class="dv">1</span><span class="op">-</span>p)<span class="op">*</span>p<span class="op">/</span>m)<span class="co">#The standard error of the estimate</span></a>
<a class="sourceLine" id="cb34-2" title="2">se</a></code></pre></div>
<pre><code>## [1] 0.007331507</code></pre>
</div>
<div id="discussionthe-coverage-probability-is-closer-to-0.95.the-standard-error-of-the-estimate-is-small-enough.our-results-are-better-than-the-results-in-example-6.4." class="section level3">
<h3>Discussion:The coverage probability is closer to 0.95.The standard error of the estimate is small enough.Our results are better than the results in Example 6.4.</h3>
<div id="estimate-the-0.0250.050.95-and-0.975-quantiles-of-the-skewness-sqrtb_1-under-normality-by-a-monte-carlo-experiment.-compute-the-standard-error-of-the-estimates-from-2.14-using-the-normal-approximation-for-the-density-with-exact-variance-formula.-compare-the-estimated-quantiles-with-the-quantiles-of-the-large-sample-approximation-sqrtb_1-approx-n06-n" class="section level4">
<h4>Estimate the <span class="math inline">\(0.025,0.05,0.95,\)</span> and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_{1}}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from ( 2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_{1}} \approx N(0,6 / n)\)</span></h4>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">m&lt;-<span class="dv">100</span><span class="co">#Monte Carlo estimation times</span></a>
<a class="sourceLine" id="cb36-2" title="2">n&lt;-<span class="dv">200</span><span class="co">#sample size</span></a>
<a class="sourceLine" id="cb36-3" title="3">N&lt;-<span class="dv">100</span><span class="co">#Number of repeated sampling</span></a>
<a class="sourceLine" id="cb36-4" title="4">skew&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb36-5" title="5">p&lt;-<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb36-6" title="6">q&lt;-<span class="kw">matrix</span>(m<span class="op">*</span><span class="dv">4</span>,<span class="dt">nrow=</span>m,<span class="dt">ncol=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb36-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb36-8" title="8">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb36-9" title="9">    x&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)<span class="co">#generate n samples from normal distribution</span></a>
<a class="sourceLine" id="cb36-10" title="10">    skew[j]&lt;-<span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">*</span><span class="dv">3</span><span class="op">/</span>(<span class="kw">var</span>(x))<span class="op">*</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>))<span class="co">#compute skew of n samples</span></a>
<a class="sourceLine" id="cb36-11" title="11">  }</a>
<a class="sourceLine" id="cb36-12" title="12">  q[i,]&lt;-<span class="kw">quantile</span>(skew,<span class="dt">probs=</span>p)<span class="co">#compute quantiles of N skew</span></a>
<a class="sourceLine" id="cb36-13" title="13">}</a>
<a class="sourceLine" id="cb36-14" title="14">quantile&lt;-<span class="kw">apply</span>(q,<span class="dv">2</span>,mean)<span class="co">#the estimates of quantiles</span></a>
<a class="sourceLine" id="cb36-15" title="15">quantile</a></code></pre></div>
<pre><code>## [1] -1.279180e-16 -1.121359e-16  1.131390e-16  1.291526e-16</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">ql&lt;-<span class="kw">qnorm</span>(p,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span><span class="dv">100000</span>))<span class="co">#the quantiles of large sample approximation</span></a>
<a class="sourceLine" id="cb38-2" title="2">ql</a></code></pre></div>
<pre><code>## [1] -0.01518182 -0.01274098  0.01274098  0.01518182</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">f&lt;-<span class="kw">dnorm</span>(quantile,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))<span class="co">#the density of the normal distribution</span></a>
<a class="sourceLine" id="cb40-2" title="2">v&lt;-<span class="kw">numeric</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb40-3" title="3"><span class="cf">for</span>(a <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb40-4" title="4">  v[a]&lt;-p[a]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p[a])<span class="op">/</span>(m<span class="op">*</span>(f[a])<span class="op">^</span><span class="dv">2</span>)<span class="co">#The standard error of the estimate</span></a>
<a class="sourceLine" id="cb40-5" title="5">}</a>
<a class="sourceLine" id="cb40-6" title="6">v</a></code></pre></div>
<pre><code>## [1] 4.594579e-05 8.953539e-05 8.953539e-05 4.594579e-05</code></pre>
</div>
</div>
<div id="discussionthe-result-of-monte-carlo-method-is-better-than-that-of-large-sample-approximation.-the-sample-error-is-also-small." class="section level3">
<h3>Discussion:The result of Monte Carlo method is better than that of large sample approximation. The sample error is also small.</h3>
</div>
</div>
<div id="hw-5" class="section level2">
<h2>HW-5:</h2>
<div id="estimate-the-power-of-the-skewness-test-of-normality-against-symmetric-betaα-α-distributions-and-comment-on-the-results.-are-the-results-different-for-heavy-tailed-symmetric-alternatives-such-as-tν" class="section level4">
<h4>Estimate the power of the skewness test of normality against symmetric Beta(α, α) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as t(ν)?</h4>
</div>
<div id="betaα-α" class="section level4">
<h4>Beta(α, α)</h4>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb42-2" title="2">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb42-3" title="3">  <span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb42-4" title="4">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb42-5" title="5">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb42-6" title="6">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb42-7" title="7">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb42-8" title="8">}</a>
<a class="sourceLine" id="cb42-9" title="9">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb42-10" title="10">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb42-11" title="11">m &lt;-<span class="st"> </span><span class="dv">2500</span></a>
<a class="sourceLine" id="cb42-12" title="12">beta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">.5</span>), <span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb42-13" title="13">N &lt;-<span class="st"> </span><span class="kw">length</span>(beta)</a>
<a class="sourceLine" id="cb42-14" title="14">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb42-15" title="15"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb42-16" title="16">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb42-17" title="17"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb42-18" title="18">  b &lt;-<span class="st"> </span>beta[j]</a>
<a class="sourceLine" id="cb42-19" title="19">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb42-20" title="20">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb42-21" title="21">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, b, b)</a>
<a class="sourceLine" id="cb42-22" title="22">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb42-23" title="23">  }</a>
<a class="sourceLine" id="cb42-24" title="24">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb42-25" title="25">}</a>
<a class="sourceLine" id="cb42-26" title="26"><span class="co">#plot power vs beta</span></a>
<a class="sourceLine" id="cb42-27" title="27"><span class="kw">plot</span>(beta, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">pch=</span><span class="dv">19</span>,<span class="dt">cex=</span><span class="fl">0.5</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(beta), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb42-28" title="28"><span class="kw">abline</span>(<span class="dt">h =</span> alpha, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb42-29" title="29">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb42-30" title="30"><span class="kw">lines</span>(beta, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb42-31" title="31"><span class="kw">lines</span>(beta, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="power-has-always-been-at-a-low-level-indicating-that-the-hypothesis-test-for-beta-distribution-skewness-is-not-good." class="section level4">
<h4>Power has always been at a low level, indicating that the hypothesis test for beta distribution skewness is not good.</h4>
</div>
<div id="tν" class="section level4">
<h4>t(ν)</h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb43-2" title="2">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb43-3" title="3">  <span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb43-4" title="4">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb43-5" title="5">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb43-6" title="6">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-7" title="7">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb43-8" title="8">}</a>
<a class="sourceLine" id="cb43-9" title="9">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb43-10" title="10">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb43-11" title="11">m &lt;-<span class="st"> </span><span class="dv">2500</span></a>
<a class="sourceLine" id="cb43-12" title="12">degree &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb43-13" title="13">N &lt;-<span class="st"> </span><span class="kw">length</span>(degree)</a>
<a class="sourceLine" id="cb43-14" title="14">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb43-15" title="15"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb43-16" title="16">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb43-17" title="17"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb43-18" title="18">  df &lt;-<span class="st"> </span>degree[j]</a>
<a class="sourceLine" id="cb43-19" title="19">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb43-20" title="20">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb43-21" title="21">    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,df)</a>
<a class="sourceLine" id="cb43-22" title="22">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb43-23" title="23">  }</a>
<a class="sourceLine" id="cb43-24" title="24">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb43-25" title="25">}</a>
<a class="sourceLine" id="cb43-26" title="26"><span class="co">#plot power vs degree</span></a>
<a class="sourceLine" id="cb43-27" title="27"><span class="kw">plot</span>(degree, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">pch=</span><span class="dv">19</span>,<span class="dt">cex=</span><span class="fl">0.5</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(degree), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb43-28" title="28"><span class="kw">abline</span>(<span class="dt">h =</span> alpha, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb43-29" title="29">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb43-30" title="30"><span class="kw">lines</span>(degree, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb43-31" title="31"><span class="kw">lines</span>(degree, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="when-the-degree-of-freedom-of-t-distribution-is-low-the-value-of-power-is-large-which-shows-that-the-hypothesis-test-of-skewness-is-good.-however-with-the-increase-of-degrees-of-freedom-the-power-value-gradually-decreases-and-finally-maintains-at-a-low-level-which-indicates-that-the-hypothesis-test-effect-of-skewness-is-poor-at-this-time." class="section level4">
<h4>When the degree of freedom of t distribution is low, the value of power is large, which shows that the hypothesis test of skewness is good. However, with the increase of degrees of freedom, the power value gradually decreases, and finally maintains at a low level, which indicates that the hypothesis test effect of skewness is poor at this time.</h4>
</div>
<div id="use-monte-carlo-simulation-to-investigate-whether-the-empirical-type-i-error-rate-of-the-t-test-is-approximately-equal-to-the-nominal-significance-level-α-when-the-sampled-population-is-non-normal.-the-t-test-is-robust-to-mild-departures-from-normality.-discuss-the-simulation-results-for-the-cases-where-the-sampled-population-is-i-χ21-ii-uniform02-and-iii-exponentialrate1.-in-each-case-test-h0-µ-µ0-vs-h0-µ-µ0-where-µ0-is-the-mean-of-χ21-uniform02-and-exponential1-respectively." class="section level4">
<h4>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level α, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) χ2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test H0 : µ = µ0 vs H0 : µ =/ µ0, where µ0 is the mean of χ2(1), Uniform(0,2), and Exponential(1), respectively.</h4>
</div>
<div id="χ21" class="section level4">
<h4>χ2(1)</h4>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb44-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> </a>
<a class="sourceLine" id="cb44-3" title="3">miu &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># Null hypothesis!</span></a>
<a class="sourceLine" id="cb44-4" title="4">m &lt;-<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb44-5" title="5">n &lt;-<span class="st"> </span><span class="dv">60</span></a>
<a class="sourceLine" id="cb44-6" title="6"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb44-7" title="7">p.val1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb44-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb44-9" title="9">x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb44-10" title="10">hat&lt;-<span class="kw">sqrt</span>(n)<span class="op">*</span>(<span class="kw">mean</span>(x)<span class="op">-</span>miu)</a>
<a class="sourceLine" id="cb44-11" title="11">se&lt;-<span class="kw">var</span>(x)</a>
<a class="sourceLine" id="cb44-12" title="12">p.val1[i] &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(hat<span class="op">/</span>se),n<span class="dv">-1</span>)) <span class="co"># t-test p-value</span></a>
<a class="sourceLine" id="cb44-13" title="13">}</a>
<a class="sourceLine" id="cb44-14" title="14"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span>alpha),alpha))</a></code></pre></div>
<pre><code>## [1] 0.0702 0.0500</code></pre>
</div>
<div id="uniform02" class="section level4">
<h4>Uniform(0,2)</h4>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb46-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> </a>
<a class="sourceLine" id="cb46-3" title="3">miu &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># Null hypothesis!</span></a>
<a class="sourceLine" id="cb46-4" title="4">m &lt;-<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb46-5" title="5">n &lt;-<span class="st"> </span><span class="dv">60</span></a>
<a class="sourceLine" id="cb46-6" title="6"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb46-7" title="7">p.val1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb46-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb46-9" title="9">x&lt;-<span class="kw">runif</span>(n,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb46-10" title="10">hat&lt;-<span class="kw">sqrt</span>(n)<span class="op">*</span>(<span class="kw">mean</span>(x)<span class="op">-</span>miu)</a>
<a class="sourceLine" id="cb46-11" title="11">se&lt;-<span class="kw">var</span>(x)</a>
<a class="sourceLine" id="cb46-12" title="12">p.val1[i] &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(hat<span class="op">/</span>se),n<span class="dv">-1</span>)) <span class="co"># t-test p-value</span></a>
<a class="sourceLine" id="cb46-13" title="13">}</a>
<a class="sourceLine" id="cb46-14" title="14"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span>alpha),alpha))</a></code></pre></div>
<pre><code>## [1] 0.2493 0.0500</code></pre>
</div>
<div id="exponential1" class="section level4">
<h4>Exponential(1)</h4>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb48-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> </a>
<a class="sourceLine" id="cb48-3" title="3">miu &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># Null hypothesis!</span></a>
<a class="sourceLine" id="cb48-4" title="4">m &lt;-<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb48-5" title="5">n &lt;-<span class="st"> </span><span class="dv">60</span></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb48-7" title="7">p.val1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb48-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb48-9" title="9">x&lt;-<span class="kw">rexp</span>(n,<span class="dt">rate=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb48-10" title="10">hat&lt;-<span class="kw">sqrt</span>(n)<span class="op">*</span>(<span class="kw">mean</span>(x)<span class="op">-</span>miu)</a>
<a class="sourceLine" id="cb48-11" title="11">se&lt;-<span class="kw">var</span>(x)</a>
<a class="sourceLine" id="cb48-12" title="12">p.val1[i] &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(hat<span class="op">/</span>se),n<span class="dv">-1</span>)) <span class="co"># t-test p-value</span></a>
<a class="sourceLine" id="cb48-13" title="13">}</a>
<a class="sourceLine" id="cb48-14" title="14"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span>alpha),alpha))</a></code></pre></div>
<pre><code>## [1] 0.0936 0.0500</code></pre>
</div>
<div id="the-type-i-error-rate-of-the-three-distribution-mean-tests-is-greater-than-the-nominal-confidence-level.-chi-square-distribution-is-the-closest-exponential-distribution-is-the-second-and-uniform-distribution-is-the-worst.-it-shows-that-chi-square-distribution-is-the-closest-to-normal-distribution-and-the-difference-between-uniform-distribution-and-normal-distribution-is-the-largest." class="section level4">
<h4>The Type I error rate of the three distribution mean tests is greater than the nominal confidence level. Chi square distribution is the closest, exponential distribution is the second, and uniform distribution is the worst. It shows that chi square distribution is the closest to normal distribution, and the difference between uniform distribution and normal distribution is the largest.</h4>
</div>
<div id="discussion-homework" class="section level4">
<h4>Discussion (homework)</h4>
</div>
<div id="if-we-obtain-the-powers-for-two-methods-under-a-particular-simulation-setting-with-10000-experiments-say-0.651-for-one-method-and-0.676-for-another-method.-can-we-say-the-powers-are-diﬀerent-at-0.05-level" class="section level4">
<h4>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are diﬀerent at 0.05 level?</h4>
</div>
<div id="what-is-the-corresponding-hypothesis-test-problem" class="section level4">
<h4>What is the corresponding hypothesis test problem?</h4>
</div>
<div id="what-test-should-we-use-z-test-two-sample-t-test-paired-t-test-or-mcnemar-test" class="section level4">
<h4>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</h4>
</div>
<div id="what-information-is-needed-to-test-your-hypothesis" class="section level4">
<h4>What information is needed to test your hypothesis?</h4>
</div>
<div id="the-corresponding-hypothesis-test-problem-is-can-we-say-the-powers-are-diﬀerent-at-0.05-level.the-null-hypothesis-is-there-is-no-difference-between-the-two-methods-at-0.05-level." class="section level4">
<h4>The corresponding hypothesis test problem is can we say the powers are diﬀerent at 0.05 level.The null hypothesis is there is no difference between the two methods at 0.05 level.</h4>
</div>
<div id="we-should-use-mcnemar-test.because-mcnemar-test-focuses-on-the-differences-between-the-two-evaluation-methods." class="section level4">
<h4>We should use McNemar test.Because McNemar test focuses on the differences between the two evaluation methods.</h4>
</div>
<div id="we-need-the-powers-for-two-methods-assuming-p1-and-p2-respectively.-ap1p2bp11-p2cp21-p1d1-p11-p2-the-statistic-is-b-c-2-b-c-which-obeys-the-chi-square-distribution-of-degree-of-freedom-1." class="section level4">
<h4>We need the powers for two methods, assuming p1 and p2 respectively. a=p1p2,b=p1(1-p2),c=p2(1-p1),d=(1-p1)(1-p2)。 The statistic is (b-c) ^ 2 / (b + c), which obeys the chi square distribution of degree of freedom 1.</h4>
</div>
</div>
<div id="hw-6" class="section level2">
<h2>HW-6:</h2>
<div id="efron-and-tibshirani-discuss-the-scor-bootstrap-test-score-data-on-88-students-who-took-examinations-in-five-subjects-84-table-7.1-188-table-1.2.1.the-first-two-tests-mechanics-vectors-were-closed-book-and-the-last-three-tests-algebra-analysis-statistics-were-open-book.-each-row-of-the-data-frame-is-a-set-of-scores-xi1-.-.-.-xi5-for-the-ith-student.-use-a-panel-display-to-display-the-scatter-plots-for-each-pair-of-test-scores.-compare-the-plot-with-the-sample-correlation-matrix.-obtain-bootstrap-estimates-of-the-standard-errors-for-each-of-the-following-estimates-ˆ-ρ12-ˆ-ρmec-vec-ˆ-ρ34-ˆ-ρalg-ana-ˆ-ρ35-ˆ-ρalg-sta-ˆ-ρ45-ˆ-ρana-sta." class="section level4">
<h4>7.6 Efron and Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in five subjects [84, Table 7.1], [188, Table 1.2.1].The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores (xi1, . . . , xi5) for the ith student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: ˆ ρ12 = ˆ ρ(mec, vec), ˆ ρ34 = ˆ ρ(alg, ana), ˆ ρ35 = ˆ ρ(alg, sta), ˆ ρ45 = ˆ ρ(ana, sta).</h4>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb50-3" title="3">score&lt;-<span class="kw">as.matrix</span>(scor)</a>
<a class="sourceLine" id="cb50-4" title="4"><span class="co">#display the scatter plots for each pair of test scores</span></a>
<a class="sourceLine" id="cb50-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb50-6" title="6">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb50-7" title="7">    <span class="cf">if</span>(j<span class="op">&gt;</span>i) <span class="kw">plot</span>(score[,i],score[,j],<span class="dt">xlab=</span><span class="kw">colnames</span>(score)[i],<span class="dt">ylab=</span><span class="kw">colnames</span>(score)[j])</a>
<a class="sourceLine" id="cb50-8" title="8">  }</a>
<a class="sourceLine" id="cb50-9" title="9">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6ZmY6kNtmAABmADpmtv+QOgCQZgCQkGaQ2/+2ZgC2tma225C2/7a2///bkDrb////tmb/25D//7b//9v///+PjmTkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ6klEQVR4nO2djXbjJhCFSZqkbbKbNm4brZPo/V+zQgiEfuAOGGQpvnfP+tjSaJA/w8wgI0e1VFTq2iewdxEQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEVBqQOo2sBKuvO9yx9T85w/Yhh67cDpKTOneH6ESq4J+KvoGoBUlLvznD9iNluccvFREDbupv5PS6g9OSQ3ELLGAQ8M4ttKgICIiAgAgKqBOjr1eSq+/ci7q6oOoAa9WyenO2Ti9wVUTS7hXdWAfT16rA0D78udldE0ZomsrMKoM+Xn/bpOTDItgYUrbBjO2+lB+0LUBeDhi60jxjkpja7AdQNMpPFAv1nW0B9hNlVDNreHW4qPkHeOItFT6TibD4w6/QeB5sal5rTslhwaOW4kyowUMZLOx0WPNxWjy5p2GpAfz4FgnOOO6GCoXbgMV4ASrmOUQnQc5fIHku5Eyqci8ywMs/avQDSKT7CaFNA445dAWp7RhtW0vHQMvLbQwwCEahSmo+nR7N3J1nsOoDAjHTAV+kb5SMUiqL5hDJj7KpDbHt3vtMYIJvP5IS+F6BJ+J2NI7NrKBZvE5Aa/o0tqLXd6lYBDQF40sCUkK2CbjQGzSalK82M8/rdZrGas3kMCJSSEa8lDa/izvlUgVd2Y/In850Azd5+mW76rQClSoLwlgGJItINAwKXRyZWYnfFtD2gxXi6cUB2gZhbRrZo9LYBDTwcllDdeKsxyNbM7sV63XijWWz8pnlyiSOv1W8IyOswwyWOyWDL8FbWcDt36ItU5ej0T/MK6wxAdmFCcHld0XZXD3YXxlbcjFP20fSC5jIAnR5+NY/tx9PPiHW5dgPHKq+nrHlWgZdZjaUZ6q8szg+/gkuj4l4KXO5YZKiV/Sr4Mq+1FEO9vu7jj/f+/wbthg5dB7T2rddls/p0QHp93eePt6sDWvQU5W0qd0UuIwY1XXQ+PecNsfR2A8f2/9XqSLogpwcaSzU8PepMdlESK5HFlv6mAW45+nK61ZHroIk/E3zGkTZtwmxVGc1mBOku/miFVkD32vpWBDObUMPXXovaZ6wXk9vNB9REAG19K8Lwjan/xeks09svw6oDOo2VTHgFR8WF5KG7A23trOy0YjLANgQ09qCI6t2KEJ9etDYOrR61VQwSqFoPCk4vbPIak9iyBtgsi5klmuFF9G3pWxGmX7ivvc3pDGZYSOYeAwcJG0837CarH0+PuhoKq+StCN6wcsF4bmKTvIvQw0PesMo60clc7Nz1kGiaL9fudFitL12Z9hX3aK+KXFaUJhtqQKcOTizNh72kz+bV5NFWfFMLb+hdH1A3tvStBp8v0YXivSLXjLIBtcu3bFN7O+Z372NQ4D4WUfNJhl18uXv7eo3wsREoUkvnxiCHYm7gAo63ktXfIG8v80STWhiSV5EeNElBajUhWQJ+pndJLH4vHW68uGEvc79PIUCT4wKVtLJO/czl19RqxV7UYHHDQae7txqAovKmGv1L5Q3I2dRDfALVAOkJ69aAJqGnnT3O2xaeQT1AXf/5rS4gG3LGV27C4U06lllsL4D0RaGagMaK2b2y1fP4YqWs3A+guu78stC9ckPMbViLyPuIQbXdrQJq1UjJbFmtgvaQxaq7GyeoXv3sQpFDd1kVdGBAk7K5dTWQl8f8AHR7gCaFczsmLXclyI6jgwHKmM3HTmcsmG3KsgNvTF4pETnYUEnDbdxNAbmC0I4uP7lf9mkcFdCkY3jhZpbFLtdhAU06hk1dl4ecZTPFDa/kzltsV9T54QGNlxBbL7ddGnk8/8UNt3U37TTK314G0cEB+Xne9zpm/jItlDTc1N3IZRp7shdzBFooabipO7eeYzaibg1QOJyEklbgUlC6DgEonLq9HjTfs7bMI0NXBSTMM5HiL1YXHj+LSWu6KYVZrPF31dAVAYnf3MRwRrV04RxovKRh3It3uUP+6XsUFgeVnJiG2i5rKHaXMDxGBsq+dsDcJKwOpyPEoOVpuCPHeqfWWDtCFlsc6FMaHqtF60PUQf5x0/UatwVI0KH8CYQbY2q6qawqAcq5FUEQRSwGP6153w0eJwbl3Iog6QPOZqWzHSmLZS0kTwK0naoAyroVQfTmqxfOqy2WNWxzb0UQvfm6ZfNag8UNtfJuRdj8zUtUKYvV/asIW5LcUx2UcuxmhK44m8/2UfB8pK2VNKzujoBEhx4aUNl7NVaPPXgM+npF90rdehaL3gyU7u6KqhWDzuE15MbdYVQJUIZCLextexnzDO0NBAFlbi9jnqG9gSCgzO1lzDO0NxAElLm9jHmG9gaCgDK3lzG/PREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAdUD1C/47JcRnZW6g7+k2+vUr6sR2n88DX/YXWjfdOfzM+182oqAvl67k2j0Ozh3T86iMzr3C4+E9vpvXPS/+ii0b7SZJiQ/H61qgMwPnTX372bhXvQnYgd9vmhAQntjJvdvvhTuzOTn06tyDOo+KUcKGjcPf3WAhPYfvw99QGjvAMnPp1dlQKf7d/NOBL+h2xnqGCS0P9//99LHOKl/O8TE52NUF5Be7GmGOx70uutrQEL7Rq/A0d1C6t/GZrG9UVVAZxujJSekVxanALobOoLUv/6p448n+Qc2qCYgs1hY2KV7s4QhZoJIF1Ck/m3o2c8Qa/yfxoVBsRmWpfwU2pt32L1bqb3tOLsJ0nbVeUpaPcnTvLkv4ixO84aL3N6qYh1kF+MnFGanhEKxsTCF9jYG7aVQHIaMPpEmcaohtD/bqYzQ/pRob8TJKhABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQ0P4BeT9veQ0REBABAe0Y0MmsjO8Bdc/v/pavWSmo/QLSa8D0Sk0NSC9+Oics6imo3QL6/PFm1s11gMzyuRMBzXXWY6wDZBZsypfNldR+ATVK3f9relBDQEv1w2oYYuxBK+qhnJUXgxoC8mU6j3pmFgupX6zbZS5bB93/I10cX1T7BbSQ+PaKojoEoD4Gfb4Efke/rg4BqF9UD35FtpaOAeiKIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgL6H8Jrl/G8Qkh6AAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co">#compute the sample correlation matrix</span></a>
<a class="sourceLine" id="cb51-2" title="2">cor&lt;-<span class="kw">as.matrix</span>(<span class="kw">cor</span>(score))</a>
<a class="sourceLine" id="cb51-3" title="3">cor</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co">#function to obtain bootstrap estimates of correlation</span></a>
<a class="sourceLine" id="cb53-2" title="2">cor.b&lt;-<span class="cf">function</span>(x,y,B){</a>
<a class="sourceLine" id="cb53-3" title="3">  n&lt;-<span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb53-4" title="4">  corstar&lt;-<span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb53-5" title="5">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb53-6" title="6">    xstar&lt;-<span class="kw">sample</span>(x,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb53-7" title="7">    ystar&lt;-<span class="kw">sample</span>(y,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb53-8" title="8">    corstar[i]&lt;-<span class="kw">cor</span>(xstar,ystar)</a>
<a class="sourceLine" id="cb53-9" title="9">  }</a>
<a class="sourceLine" id="cb53-10" title="10">  <span class="kw">return</span>(corstar)</a>
<a class="sourceLine" id="cb53-11" title="11">}</a>
<a class="sourceLine" id="cb53-12" title="12">B&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb53-13" title="13">cor12.b&lt;-<span class="kw">cor.b</span>(score[,<span class="dv">1</span>],score[,<span class="dv">2</span>],B)</a>
<a class="sourceLine" id="cb53-14" title="14">cor34.b&lt;-<span class="kw">cor.b</span>(score[,<span class="dv">3</span>],score[,<span class="dv">4</span>],B)</a>
<a class="sourceLine" id="cb53-15" title="15">cor35.b&lt;-<span class="kw">cor.b</span>(score[,<span class="dv">3</span>],score[,<span class="dv">5</span>],B)</a>
<a class="sourceLine" id="cb53-16" title="16">cor45.b&lt;-<span class="kw">cor.b</span>(score[,<span class="dv">4</span>],score[,<span class="dv">5</span>],B)</a>
<a class="sourceLine" id="cb53-17" title="17">SE&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">sd</span>(cor12.b),<span class="kw">sd</span>(cor34.b),<span class="kw">sd</span>(cor35.b),<span class="kw">sd</span>(cor45.b)),<span class="dt">nrow=</span><span class="dv">1</span>,<span class="dt">ncol=</span><span class="dv">4</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>,<span class="dt">dimnames=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;SE&quot;</span>),<span class="kw">c</span>(<span class="st">&quot;SE12.b&quot;</span>,<span class="st">&quot;SE34.b&quot;</span>,<span class="st">&quot;SE35.b&quot;</span>,<span class="st">&quot;SE45.b&quot;</span>)))</a>
<a class="sourceLine" id="cb53-18" title="18">SE</a></code></pre></div>
<pre><code>##        SE12.b    SE34.b     SE35.b    SE45.b
## SE 0.09429456 0.1174883 0.09752036 0.1067267</code></pre>
</div>
<div id="the-more-the-center-points-of-the-scatter-plot-gather-around-the-line-the-greater-the-correlation-coefficient-of-the-two-variables.-the-more-dispersed-the-point-the-smaller-the-correlation-coefficient.-bootstrap-estimates-of-the-standard-errors-are-near-0.1." class="section level4">
<h4>The more the center points of the scatter plot gather around the line, the greater the correlation coefficient of the two variables. The more dispersed the point, the smaller the correlation coefficient. Bootstrap estimates of the standard errors are near 0.1.</h4>
</div>
<div id="b-repeat-project-7.a-for-the-sample-skewness-statistic.-compare-the-coverage-rates-for-normal-populations-skewness-0-and-χ25-distributions-positive-skewness." class="section level4">
<h4>7.B Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and χ2(5) distributions (positive skewness).</h4>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb55-2" title="2"><span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb55-3" title="3">sk&lt;-<span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb55-4" title="4">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb55-5" title="5">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb55-6" title="6">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb55-7" title="7">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb55-8" title="8">}</a>
<a class="sourceLine" id="cb55-9" title="9"><span class="co">#normal populations</span></a>
<a class="sourceLine" id="cb55-10" title="10">alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb55-11" title="11">M&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb55-12" title="12">B&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb55-13" title="13">n&lt;-<span class="dv">2000</span></a>
<a class="sourceLine" id="cb55-14" title="14">sk.star&lt;-<span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb55-15" title="15">se&lt;-up&lt;-down&lt;-<span class="kw">numeric</span>(M)</a>
<a class="sourceLine" id="cb55-16" title="16"></a>
<a class="sourceLine" id="cb55-17" title="17"><span class="co">#estimate the coverage probabilities of the standard normal bootstrap confidence interval</span></a>
<a class="sourceLine" id="cb55-18" title="18"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){</a>
<a class="sourceLine" id="cb55-19" title="19">  xhat&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb55-20" title="20">  sk.hat&lt;-<span class="kw">sk</span>(xhat)</a>
<a class="sourceLine" id="cb55-21" title="21">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb55-22" title="22">    xstar&lt;-<span class="kw">sample</span>(xhat,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb55-23" title="23">    sk.star[j]&lt;-<span class="kw">sk</span>(xstar)</a>
<a class="sourceLine" id="cb55-24" title="24">  }</a>
<a class="sourceLine" id="cb55-25" title="25">  se[i]&lt;-<span class="kw">sd</span>(sk.star)</a>
<a class="sourceLine" id="cb55-26" title="26">  up[i]&lt;-(sk.hat<span class="op">-</span><span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)<span class="op">*</span>se[i])</a>
<a class="sourceLine" id="cb55-27" title="27">  down[i]&lt;-(sk.hat<span class="op">-</span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)<span class="op">*</span>se[i])</a>
<a class="sourceLine" id="cb55-28" title="28">}</a>
<a class="sourceLine" id="cb55-29" title="29">CP.s&lt;-<span class="kw">mean</span>(down<span class="op">&lt;</span><span class="dv">0</span><span class="op">&amp;</span>up<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb55-30" title="30">s.left&lt;-<span class="kw">mean</span>(down<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb55-31" title="31">s.right&lt;-<span class="kw">mean</span>(up<span class="op">&lt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb55-32" title="32"><span class="co">#estimate the coverage probabilities of the basic bootstrap confidence interval</span></a>
<a class="sourceLine" id="cb55-33" title="33"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){</a>
<a class="sourceLine" id="cb55-34" title="34">  xhat&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb55-35" title="35">  sk.hat&lt;-<span class="kw">sk</span>(xhat)</a>
<a class="sourceLine" id="cb55-36" title="36">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb55-37" title="37">    xstar&lt;-<span class="kw">sample</span>(xhat,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb55-38" title="38">    sk.star[j]&lt;-<span class="kw">sk</span>(xstar)</a>
<a class="sourceLine" id="cb55-39" title="39">  }</a>
<a class="sourceLine" id="cb55-40" title="40">  up[i]&lt;-(<span class="dv">2</span><span class="op">*</span>sk.hat<span class="op">-</span><span class="kw">quantile</span>(sk.star,<span class="dt">probs=</span>alpha<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb55-41" title="41">  down[i]&lt;-(<span class="dv">2</span><span class="op">*</span>sk.hat<span class="op">-</span><span class="kw">quantile</span>(sk.star,<span class="dt">probs=</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb55-42" title="42">}</a>
<a class="sourceLine" id="cb55-43" title="43">CP.b&lt;-<span class="kw">mean</span>(down<span class="op">&lt;</span><span class="dv">0</span><span class="op">&amp;</span>up<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb55-44" title="44">b.left&lt;-<span class="kw">mean</span>(down<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb55-45" title="45">b.right&lt;-<span class="kw">mean</span>(up<span class="op">&lt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb55-46" title="46"><span class="co">#estimate the coverage probabilities of the percentile confidence interval</span></a>
<a class="sourceLine" id="cb55-47" title="47"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){</a>
<a class="sourceLine" id="cb55-48" title="48">  xhat&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb55-49" title="49">  sk.hat&lt;-<span class="kw">sk</span>(xhat)</a>
<a class="sourceLine" id="cb55-50" title="50">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb55-51" title="51">    xstar&lt;-<span class="kw">sample</span>(xhat,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb55-52" title="52">    sk.star[j]&lt;-<span class="kw">sk</span>(xstar)</a>
<a class="sourceLine" id="cb55-53" title="53">  }</a>
<a class="sourceLine" id="cb55-54" title="54">  up[i]&lt;-<span class="kw">quantile</span>(sk.star,<span class="dt">probs=</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb55-55" title="55">  down[i]&lt;-<span class="kw">quantile</span>(sk.star,<span class="dt">probs=</span>alpha<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb55-56" title="56">}</a>
<a class="sourceLine" id="cb55-57" title="57">CP.p&lt;-<span class="kw">mean</span>(down<span class="op">&lt;</span><span class="dv">0</span><span class="op">&amp;</span>up<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb55-58" title="58">p.left&lt;-<span class="kw">mean</span>(down<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb55-59" title="59">p.right&lt;-<span class="kw">mean</span>(up<span class="op">&lt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb55-60" title="60"></a>
<a class="sourceLine" id="cb55-61" title="61">norm&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(CP.s,s.left,s.right,CP.b,b.left,b.right,CP.p,p.left,p.right),<span class="dt">nrow=</span><span class="dv">1</span>,<span class="dt">ncol=</span><span class="dv">9</span>)</a>
<a class="sourceLine" id="cb55-62" title="62"></a>
<a class="sourceLine" id="cb55-63" title="63"><span class="co">#χ2(5) distributions</span></a>
<a class="sourceLine" id="cb55-64" title="64">sk1&lt;-<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb55-65" title="65">sk.star&lt;-<span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb55-66" title="66">se&lt;-up&lt;-down&lt;-<span class="kw">numeric</span>(M)</a>
<a class="sourceLine" id="cb55-67" title="67"></a>
<a class="sourceLine" id="cb55-68" title="68"><span class="co">#estimate the coverage probabilities of the standard normal bootstrap confidence interval</span></a>
<a class="sourceLine" id="cb55-69" title="69"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){</a>
<a class="sourceLine" id="cb55-70" title="70">  xhat&lt;-<span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb55-71" title="71">  sk.hat&lt;-<span class="kw">sk</span>(xhat)</a>
<a class="sourceLine" id="cb55-72" title="72">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb55-73" title="73">    xstar&lt;-<span class="kw">sample</span>(xhat,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb55-74" title="74">    sk.star[j]&lt;-<span class="kw">sk</span>(xstar)</a>
<a class="sourceLine" id="cb55-75" title="75">  }</a>
<a class="sourceLine" id="cb55-76" title="76">  se[i]&lt;-<span class="kw">sd</span>(sk.star)</a>
<a class="sourceLine" id="cb55-77" title="77">  up[i]&lt;-(sk.hat<span class="op">-</span><span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)<span class="op">*</span>se[i])</a>
<a class="sourceLine" id="cb55-78" title="78">  down[i]&lt;-(sk.hat<span class="op">-</span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)<span class="op">*</span>se[i])</a>
<a class="sourceLine" id="cb55-79" title="79">}</a>
<a class="sourceLine" id="cb55-80" title="80">CP.s&lt;-<span class="kw">mean</span>(down<span class="op">&lt;</span>sk1<span class="op">&amp;</span>up<span class="op">&gt;</span>sk1)</a>
<a class="sourceLine" id="cb55-81" title="81">s.left&lt;-<span class="kw">mean</span>(down<span class="op">&gt;</span>sk1)</a>
<a class="sourceLine" id="cb55-82" title="82">s.right&lt;-<span class="kw">mean</span>(up<span class="op">&lt;</span>sk1)</a>
<a class="sourceLine" id="cb55-83" title="83"></a>
<a class="sourceLine" id="cb55-84" title="84"><span class="co">#estimate the coverage probabilities of the basic bootstrap confidence interval</span></a>
<a class="sourceLine" id="cb55-85" title="85"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){</a>
<a class="sourceLine" id="cb55-86" title="86">  xhat&lt;-<span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb55-87" title="87">  sk.hat&lt;-<span class="kw">sk</span>(xhat)</a>
<a class="sourceLine" id="cb55-88" title="88">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb55-89" title="89">    xstar&lt;-<span class="kw">sample</span>(xhat,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb55-90" title="90">    sk.star[j]&lt;-<span class="kw">sk</span>(xstar)</a>
<a class="sourceLine" id="cb55-91" title="91">  }</a>
<a class="sourceLine" id="cb55-92" title="92">  up[i]&lt;-(<span class="dv">2</span><span class="op">*</span>sk.hat<span class="op">-</span><span class="kw">quantile</span>(sk.star,<span class="dt">probs=</span>alpha<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb55-93" title="93">  down[i]&lt;-(<span class="dv">2</span><span class="op">*</span>sk.hat<span class="op">-</span><span class="kw">quantile</span>(sk.star,<span class="dt">probs=</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb55-94" title="94">}</a>
<a class="sourceLine" id="cb55-95" title="95">CP.b&lt;-<span class="kw">mean</span>(down<span class="op">&lt;</span>sk1<span class="op">&amp;</span>up<span class="op">&gt;</span>sk1)</a>
<a class="sourceLine" id="cb55-96" title="96">b.left&lt;-<span class="kw">mean</span>(down<span class="op">&gt;</span>sk1)</a>
<a class="sourceLine" id="cb55-97" title="97">b.right&lt;-<span class="kw">mean</span>(up<span class="op">&lt;</span>sk1)</a>
<a class="sourceLine" id="cb55-98" title="98"></a>
<a class="sourceLine" id="cb55-99" title="99"><span class="co">#estimate the coverage probabilities of the percentile confidence interval</span></a>
<a class="sourceLine" id="cb55-100" title="100"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){</a>
<a class="sourceLine" id="cb55-101" title="101">  xhat&lt;-<span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb55-102" title="102">  sk.hat&lt;-<span class="kw">sk</span>(xhat)</a>
<a class="sourceLine" id="cb55-103" title="103">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb55-104" title="104">    xstar&lt;-<span class="kw">sample</span>(xhat,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb55-105" title="105">    sk.star[j]&lt;-<span class="kw">sk</span>(xstar)</a>
<a class="sourceLine" id="cb55-106" title="106">  }</a>
<a class="sourceLine" id="cb55-107" title="107">  up[i]&lt;-<span class="kw">quantile</span>(sk.star,<span class="dt">probs=</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb55-108" title="108">  down[i]&lt;-<span class="kw">quantile</span>(sk.star,<span class="dt">probs=</span>alpha<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb55-109" title="109">}</a>
<a class="sourceLine" id="cb55-110" title="110">CP.p&lt;-<span class="kw">mean</span>(down<span class="op">&lt;</span>sk1<span class="op">&amp;</span>up<span class="op">&gt;</span>sk1)</a>
<a class="sourceLine" id="cb55-111" title="111">p.left&lt;-<span class="kw">mean</span>(down<span class="op">&gt;</span>sk1)</a>
<a class="sourceLine" id="cb55-112" title="112">p.right&lt;-<span class="kw">mean</span>(up<span class="op">&lt;</span>sk1)</a>
<a class="sourceLine" id="cb55-113" title="113"></a>
<a class="sourceLine" id="cb55-114" title="114">chisq&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(CP.s,s.left,s.right,CP.b,b.left,b.right,CP.p,p.left,p.right),<span class="dt">nrow=</span><span class="dv">1</span>,<span class="dt">ncol=</span><span class="dv">9</span>)</a>
<a class="sourceLine" id="cb55-115" title="115">compare&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(norm,chisq),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">9</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>,<span class="dt">dimnames=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;chisq&quot;</span>),<span class="kw">c</span>(<span class="st">&quot;CP.standard&quot;</span>,<span class="st">&quot;standard.left&quot;</span>,<span class="st">&quot;standard.right&quot;</span>,<span class="st">&quot;CP.basic&quot;</span>,<span class="st">&quot;basic.left&quot;</span>,<span class="st">&quot;basic.right&quot;</span>,<span class="st">&quot;CP.percentile&quot;</span>,<span class="st">&quot;percentile.left&quot;</span>,<span class="st">&quot;percentile.right&quot;</span>)))</a>
<a class="sourceLine" id="cb55-116" title="116">compare</a></code></pre></div>
<pre><code>##       CP.standard standard.left standard.right CP.basic basic.left
## norm         0.94          0.05           0.01     0.92       0.05
## chisq        0.91          0.01           0.08     0.86       0.01
##       basic.right CP.percentile percentile.left percentile.right
## norm         0.03          0.96            0.03             0.01
## chisq        0.13          0.91            0.01             0.08</code></pre>
</div>
<div id="the-coverage-probability-of-normal-distribution-is-better-than-that-of-chi-square-distribution.-the-popularity-of-times-that-the-confidence-intervals-miss-on-the-right-accounts-for-the-majority." class="section level4">
<h4>The coverage probability of normal distribution is better than that of chi square distribution. The popularity of times that the confidence intervals miss on the right accounts for the majority.</h4>
</div>
</div>
<div id="hw-7" class="section level2">
<h2>HW-7:</h2>
<div id="exercise-7.8refer-to-exercise-7.7.-obtain-the-jackknife-estimates-of-bias-and-standard-error-of-θˆ." class="section level4">
<h4>Exercise 7.8:Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of θˆ.</h4>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb57-2" title="2"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb57-3" title="3">scor&lt;-<span class="kw">as.matrix</span>(scor)</a>
<a class="sourceLine" id="cb57-4" title="4">lamda&lt;-<span class="kw">eigen</span>(<span class="kw">cor</span>(scor))<span class="op">$</span>values</a>
<a class="sourceLine" id="cb57-5" title="5">theta.hat&lt;-lamda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lamda)</a>
<a class="sourceLine" id="cb57-6" title="6">J&lt;-<span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb57-7" title="7">theta.jack&lt;-<span class="kw">numeric</span>(J)</a>
<a class="sourceLine" id="cb57-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>J){</a>
<a class="sourceLine" id="cb57-9" title="9">  <span class="co">#obtain the jackknife estimates of theta</span></a>
<a class="sourceLine" id="cb57-10" title="10">  scor.hat&lt;-scor[<span class="op">-</span>i,]</a>
<a class="sourceLine" id="cb57-11" title="11">  n&lt;-<span class="kw">nrow</span>(scor.hat)</a>
<a class="sourceLine" id="cb57-12" title="12">  sigma.MLE&lt;-((n<span class="dv">-1</span>)<span class="op">/</span>n)<span class="op">*</span><span class="kw">cor</span>(scor.hat)</a>
<a class="sourceLine" id="cb57-13" title="13">  lamda.hat&lt;-<span class="kw">eigen</span>(sigma.MLE)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb57-14" title="14">  theta.jack[i]&lt;-lamda.hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lamda.hat)</a>
<a class="sourceLine" id="cb57-15" title="15">}</a>
<a class="sourceLine" id="cb57-16" title="16"><span class="co">#Obtain the jackknife estimates of bias and standard error</span></a>
<a class="sourceLine" id="cb57-17" title="17">bias.jack&lt;-(J<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</a>
<a class="sourceLine" id="cb57-18" title="18">sd.jack&lt;-<span class="kw">sqrt</span>((J<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb57-19" title="19"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias.jack=</span>bias.jack,<span class="dt">sd.jack=</span>sd.jack),<span class="dv">2</span>)</a></code></pre></div>
<pre><code>## bias.jack   sd.jack 
##      0.00      0.04</code></pre>
</div>
<div id="discussion-the-jackknife-estimates-of-bias-is-zero.the-jackknife-estimates-of-standard-error-is-close-to-zero." class="section level4">
<h4>Discussion: The jackknife estimates of bias is zero.The jackknife estimates of standard error is close to zero.</h4>
</div>
<div id="exercise-7.10-in-example-7.18-leave-one-out-n-fold-cross-validation-was-used-to-select-the-best-fitting-model.-repeat-the-analysis-replacing-the-log-log-model-with-a-cubic-polynomial-model.-which-of-the-four-models-is-selected-by-the-cross-validation-procedure-which-model-is-selected-according-to-maximum-adjusted-r2" class="section level4">
<h4>Exercise 7.10: In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted R^2?</h4>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb59-2" title="2"><span class="kw">library</span>(DAAG)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb61-2" title="2">ybar&lt;-<span class="kw">mean</span>(magnetic)</a>
<a class="sourceLine" id="cb61-3" title="3">n&lt;-<span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></a>
<a class="sourceLine" id="cb61-4" title="4">e1&lt;-e2&lt;-e3&lt;-e4&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb61-5" title="5"><span class="co"># for n-fold cross validation</span></a>
<a class="sourceLine" id="cb61-6" title="6"><span class="co"># fit models on leave-one-out samples</span></a>
<a class="sourceLine" id="cb61-7" title="7"><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb61-8" title="8">  y&lt;-magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb61-9" title="9">  x&lt;-chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb61-10" title="10"></a>
<a class="sourceLine" id="cb61-11" title="11">  J1&lt;-<span class="kw">lm</span>(y<span class="op">~</span>x)</a>
<a class="sourceLine" id="cb61-12" title="12">  yhat1&lt;-J1<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[k]</a>
<a class="sourceLine" id="cb61-13" title="13">  e1[k]&lt;-magnetic[k]<span class="op">-</span>yhat1</a>
<a class="sourceLine" id="cb61-14" title="14"></a>
<a class="sourceLine" id="cb61-15" title="15">  J2&lt;-<span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb61-16" title="16">  yhat2&lt;-J2<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[k]<span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb61-17" title="17">  e2[k]&lt;-magnetic[k]<span class="op">-</span>yhat2</a>
<a class="sourceLine" id="cb61-18" title="18"></a>
<a class="sourceLine" id="cb61-19" title="19">  J3&lt;-<span class="kw">lm</span>(<span class="kw">log</span>(y)<span class="op">~</span>x)</a>
<a class="sourceLine" id="cb61-20" title="20">  logyhat3&lt;-J3<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J3<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[k]</a>
<a class="sourceLine" id="cb61-21" title="21">  yhat3&lt;-<span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb61-22" title="22">  e3[k]&lt;-magnetic[k]<span class="op">-</span>yhat3</a>
<a class="sourceLine" id="cb61-23" title="23"></a>
<a class="sourceLine" id="cb61-24" title="24">  J4&lt;-<span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb61-25" title="25">  yhat4&lt;-J4<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[k]<span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical[k]<span class="op">^</span><span class="dv">2</span><span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">4</span>]<span class="op">*</span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb61-26" title="26">  e4[k]&lt;-magnetic[k]<span class="op">-</span>yhat4</a>
<a class="sourceLine" id="cb61-27" title="27">}</a>
<a class="sourceLine" id="cb61-28" title="28"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">MSE1=</span><span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>),<span class="dt">MSE2=</span><span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>),<span class="dt">MSE3=</span><span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>),<span class="dt">MSE4=</span><span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)),<span class="dv">4</span>)</a></code></pre></div>
<pre><code>##    MSE1    MSE2    MSE3    MSE4 
## 19.5564 17.8525 18.4419 18.1776</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="co">#adjusted R^2</span></a>
<a class="sourceLine" id="cb63-2" title="2">SSE1&lt;-SSE2&lt;-SSE3&lt;-SSE4&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb63-3" title="3">SST&lt;-<span class="kw">sum</span>((magnetic<span class="op">-</span>ybar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb63-4" title="4"></a>
<a class="sourceLine" id="cb63-5" title="5">M1&lt;-<span class="kw">lm</span>(magnetic<span class="op">~</span>chemical)</a>
<a class="sourceLine" id="cb63-6" title="6">yhat1&lt;-M1<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>M1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical</a>
<a class="sourceLine" id="cb63-7" title="7">SSE1&lt;-<span class="kw">sum</span>((yhat1<span class="op">-</span>magnetic)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb63-8" title="8">R1&lt;-(<span class="dv">1</span><span class="op">-</span>SSE1<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>(SST<span class="op">*</span>(n<span class="dv">-1-1</span>)))</a>
<a class="sourceLine" id="cb63-9" title="9"></a>
<a class="sourceLine" id="cb63-10" title="10">M2&lt;-<span class="kw">lm</span>(magnetic<span class="op">~</span>chemical<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb63-11" title="11">yhat2&lt;-M2<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>M2<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical<span class="op">+</span>M2<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb63-12" title="12">SSE2&lt;-<span class="kw">sum</span>((yhat2<span class="op">-</span>magnetic)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb63-13" title="13">R2&lt;-(<span class="dv">1</span><span class="op">-</span>SSE2<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>(SST<span class="op">*</span>(n<span class="dv">-2-1</span>)))</a>
<a class="sourceLine" id="cb63-14" title="14"></a>
<a class="sourceLine" id="cb63-15" title="15">M3&lt;-<span class="kw">lm</span>(<span class="kw">log</span>(magnetic)<span class="op">~</span>chemical)</a>
<a class="sourceLine" id="cb63-16" title="16">logyhat3&lt;-M3<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>M3<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical</a>
<a class="sourceLine" id="cb63-17" title="17">yhat3&lt;-<span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb63-18" title="18">SSE3&lt;-<span class="kw">sum</span>((yhat3<span class="op">-</span>magnetic)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb63-19" title="19">R3&lt;-(<span class="dv">1</span><span class="op">-</span>SSE3<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>(SST<span class="op">*</span>(n<span class="dv">-1-1</span>)))</a>
<a class="sourceLine" id="cb63-20" title="20"></a>
<a class="sourceLine" id="cb63-21" title="21">M4&lt;-<span class="kw">lm</span>(magnetic<span class="op">~</span>chemical<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb63-22" title="22">yhat4&lt;-M4<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>M4<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical<span class="op">+</span>M4<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical<span class="op">^</span><span class="dv">2</span><span class="op">+</span>M4<span class="op">$</span>coef[<span class="dv">4</span>]<span class="op">*</span>chemical<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb63-23" title="23">SSE4&lt;-<span class="kw">sum</span>((yhat4<span class="op">-</span>magnetic)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb63-24" title="24">R4&lt;-(<span class="dv">1</span><span class="op">-</span>SSE4<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>(SST<span class="op">*</span>(n<span class="dv">-3-1</span>)))</a>
<a class="sourceLine" id="cb63-25" title="25"></a>
<a class="sourceLine" id="cb63-26" title="26"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">adjusted.R1=</span>R1,<span class="dt">adjusted.R2=</span>R2,<span class="dt">adjusted.R3=</span>R3,<span class="dt">adjusted.R4=</span>R4),<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## adjusted.R1 adjusted.R2 adjusted.R3 adjusted.R4 
##      0.5282      0.5768      0.5522      0.5740</code></pre>
</div>
<div id="discussion-since-the-second-model-has-the-least-mse-the-second-model-would-be-selected-by-the-cv-procedure.besides-the-second-model-also-has-the-biggest-adjusted-r2.it-would-be-selected-according-to-maximun-adjusted-r2." class="section level4">
<h4>Discussion: Since the second model has the least MSE, the second model would be selected by the CV procedure.Besides, the second model also has the biggest adjusted R^2.It would be selected according to maximun adjusted R^2.</h4>
</div>
</div>
<div id="hw-8" class="section level2">
<h2>HW-8:</h2>
<div id="section-4" class="section level4">
<h4>8.3</h4>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb65-2" title="2">count5&lt;-<span class="cf">function</span>(x1,x2){</a>
<a class="sourceLine" id="cb65-3" title="3">  R&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb65-4" title="4">  T1&lt;-T2&lt;-<span class="kw">numeric</span>(R)</a>
<a class="sourceLine" id="cb65-5" title="5">  z&lt;-<span class="kw">c</span>(x1,x2)</a>
<a class="sourceLine" id="cb65-6" title="6">  n&lt;-<span class="kw">length</span>(z)</a>
<a class="sourceLine" id="cb65-7" title="7">  K&lt;-<span class="dv">1</span><span class="op">:</span>n</a>
<a class="sourceLine" id="cb65-8" title="8">  n1&lt;-<span class="kw">length</span>(x1)</a>
<a class="sourceLine" id="cb65-9" title="9">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){</a>
<a class="sourceLine" id="cb65-10" title="10">    k&lt;-<span class="kw">sample</span>(K,n1,<span class="dt">replace=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb65-11" title="11">    x1.star&lt;-z[k]</a>
<a class="sourceLine" id="cb65-12" title="12">    x2.star&lt;-z[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb65-13" title="13">    T1[i]&lt;-<span class="kw">sum</span>(x1.star<span class="op">&gt;</span><span class="kw">max</span>(x1))<span class="op">+</span><span class="kw">sum</span>(x1.star<span class="op">&lt;</span><span class="kw">min</span>(x1))</a>
<a class="sourceLine" id="cb65-14" title="14">    T2[i]&lt;-<span class="kw">sum</span>(x2.star<span class="op">&gt;</span><span class="kw">max</span>(x2))<span class="op">+</span><span class="kw">sum</span>(x2.star<span class="op">&lt;</span><span class="kw">min</span>(x2))</a>
<a class="sourceLine" id="cb65-15" title="15">  }</a>
<a class="sourceLine" id="cb65-16" title="16">  p1&lt;-(<span class="dv">1</span><span class="op">+</span><span class="kw">sum</span>(T1<span class="op">&gt;=</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>R)</a>
<a class="sourceLine" id="cb65-17" title="17">  p2&lt;-(<span class="dv">1</span><span class="op">+</span><span class="kw">sum</span>(T2<span class="op">&gt;=</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>R)</a>
<a class="sourceLine" id="cb65-18" title="18">  <span class="kw">return</span>(<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">p1=</span>p1,<span class="dt">p2=</span>p2),<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb65-19" title="19">}</a>
<a class="sourceLine" id="cb65-20" title="20">x1&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb65-21" title="21">x2&lt;-<span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb65-22" title="22">alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb65-23" title="23">p&lt;-<span class="kw">max</span>(<span class="kw">count5</span>(x1,x2))</a>
<a class="sourceLine" id="cb65-24" title="24"><span class="cf">if</span>(p<span class="op">&gt;=</span>alpha) <span class="kw">sprintf</span>(<span class="st">&quot;p-value is %.3f.At the %.2f confidence level, the variances of two samples are different&quot;</span>,p,alpha)</a>
<a class="sourceLine" id="cb65-25" title="25"><span class="cf">if</span>(p<span class="op">&lt;</span>alpha) <span class="kw">sprintf</span>(<span class="st">&quot;p-value is %.3f.At the %.2f confidence level, the variances of two samples are equal&quot;</span>,p,alpha)</a></code></pre></div>
<pre><code>## [1] &quot;p-value is 0.001.At the 0.05 confidence level, the variances of two samples are equal&quot;</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">x1&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb67-2" title="2">x2&lt;-<span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb67-3" title="3">alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb67-4" title="4">p&lt;-<span class="kw">max</span>(<span class="kw">count5</span>(x1,x2))</a>
<a class="sourceLine" id="cb67-5" title="5"><span class="cf">if</span>(p<span class="op">&gt;=</span>alpha) <span class="kw">sprintf</span>(<span class="st">&quot;p-value is %.3f.At the %.2f confidence level, the variances of two samples are different&quot;</span>,p,alpha)</a></code></pre></div>
<pre><code>## [1] &quot;p-value is 0.447.At the 0.05 confidence level, the variances of two samples are different&quot;</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="cf">if</span>(p<span class="op">&lt;</span>alpha) <span class="kw">sprintf</span>(<span class="st">&quot;p-value is %.3f.At the %.2f confidence level, the variances of two samples are equal&quot;</span>,p,alpha)</a></code></pre></div>
</div>
<div id="the-results-show-that-our-method-can-test-whether-the-sample-variances-of-different-samples-whose-sizes-are-different-are-the-same." class="section level4">
<h4>The results show that our method can test whether the sample variances of different samples whose sizes are different are the same.</h4>
</div>
<div id="slides" class="section level4">
<h4>slides</h4>
<p>Power comparison (distance correlation test versus ball covariance test)</p>
<p>Model1: <span class="math inline">\(Y=X/4+e\)</span></p>
<p>Model2: <span class="math inline">\(Y=X/4\times e\)</span></p>
<p><span class="math inline">\(X\sim N(0_2,I_2)\)</span>, <span class="math inline">\(e\sim N(0_2,I_2)\)</span>, <span class="math inline">\(X\)</span> and <span class="math inline">\(e\)</span> are independent.</p>
<p>use the method like the slides.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">dCov&lt;-<span class="cf">function</span>(x, y){</a>
<a class="sourceLine" id="cb70-2" title="2">  x&lt;-<span class="kw">as.matrix</span>(x)</a>
<a class="sourceLine" id="cb70-3" title="3">  y&lt;-<span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb70-4" title="4">  n&lt;-<span class="kw">nrow</span>(x)</a>
<a class="sourceLine" id="cb70-5" title="5">  m&lt;-<span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb70-6" title="6">  <span class="cf">if</span>(n<span class="op">!=</span>m<span class="op">||</span>n<span class="op">&lt;</span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb70-7" title="7">  <span class="cf">if</span>(<span class="op">!</span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y))))) <span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb70-8" title="8">  Akl&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb70-9" title="9">    d&lt;-<span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb70-10" title="10">    m&lt;-<span class="kw">rowMeans</span>(d)</a>
<a class="sourceLine" id="cb70-11" title="11">    M&lt;-<span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb70-12" title="12">    a&lt;-<span class="kw">sweep</span>(d,<span class="dv">1</span>,m)</a>
<a class="sourceLine" id="cb70-13" title="13">    b&lt;-<span class="kw">sweep</span>(a,<span class="dv">2</span>,m)</a>
<a class="sourceLine" id="cb70-14" title="14">    <span class="kw">return</span>(b<span class="op">+</span>M)</a>
<a class="sourceLine" id="cb70-15" title="15">  }</a>
<a class="sourceLine" id="cb70-16" title="16">  A&lt;-<span class="kw">Akl</span>(x)</a>
<a class="sourceLine" id="cb70-17" title="17">  B&lt;-<span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb70-18" title="18">  <span class="kw">return</span>(<span class="kw">sqrt</span>(<span class="kw">mean</span>(A<span class="op">*</span>B)))</a>
<a class="sourceLine" id="cb70-19" title="19">}</a>
<a class="sourceLine" id="cb70-20" title="20">ndCov2&lt;-<span class="cf">function</span>(z,ix,dims){</a>
<a class="sourceLine" id="cb70-21" title="21"><span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb70-22" title="22">  p&lt;-dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb70-23" title="23">  q&lt;-dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb70-24" title="24">  d&lt;-p<span class="op">+</span>q</a>
<a class="sourceLine" id="cb70-25" title="25">  x&lt;-z[,<span class="dv">1</span><span class="op">:</span>p]<span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb70-26" title="26">  y&lt;-z[ix,<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)]<span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb70-27" title="27">  <span class="kw">return</span>(<span class="kw">nrow</span>(z)<span class="op">*</span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb70-28" title="28">}</a>
<a class="sourceLine" id="cb70-29" title="29"><span class="kw">library</span>(<span class="st">&quot;boot&quot;</span>)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lattice&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">library</span>(<span class="st">&quot;Ball&quot;</span>)</a>
<a class="sourceLine" id="cb73-2" title="2"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb73-3" title="3">m&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb73-4" title="4">R&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb73-5" title="5">alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb73-6" title="6">size&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>,<span class="dv">200</span>)</a>
<a class="sourceLine" id="cb73-7" title="7">b&lt;-<span class="kw">length</span>(size)</a>
<a class="sourceLine" id="cb73-8" title="8">pow1&lt;-pow2&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,b,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb73-9" title="9"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>b){</a>
<a class="sourceLine" id="cb73-10" title="10">  p.values1&lt;-p.values2&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb73-11" title="11">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb73-12" title="12">    x&lt;-<span class="kw">matrix</span>(<span class="kw">rnorm</span>(size[j]<span class="op">*</span><span class="dv">2</span>),<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb73-13" title="13">    e&lt;-<span class="kw">matrix</span>(<span class="kw">rnorm</span>(size[j]<span class="op">*</span><span class="dv">2</span>),<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb73-14" title="14">    y1&lt;-x<span class="op">/</span><span class="dv">4</span><span class="op">+</span>e</a>
<a class="sourceLine" id="cb73-15" title="15">    y2&lt;-(x<span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>e</a>
<a class="sourceLine" id="cb73-16" title="16">    z1&lt;-<span class="kw">cbind</span>(x,y1)</a>
<a class="sourceLine" id="cb73-17" title="17">    z2&lt;-<span class="kw">cbind</span>(x,y2)</a>
<a class="sourceLine" id="cb73-18" title="18">    boot.obj1&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>z1,<span class="dt">statistic=</span>ndCov2,<span class="dt">R=</span>R,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">dims=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb73-19" title="19">    <span class="co">#permutatin:resampling without replacement</span></a>
<a class="sourceLine" id="cb73-20" title="20">    p.values1[i,<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(boot.obj1<span class="op">$</span>t<span class="op">&gt;=</span>boot.obj1<span class="op">$</span>t0)</a>
<a class="sourceLine" id="cb73-21" title="21">    p.values1[i,<span class="dv">2</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y1,<span class="dt">R=</span>R,<span class="dt">seed=</span>j<span class="op">*</span>i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb73-22" title="22">    boot.obj2&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>z2,<span class="dt">statistic=</span>ndCov2,<span class="dt">R=</span>R,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">dims=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb73-23" title="23">    <span class="co">#permutatin:resampling without replacement</span></a>
<a class="sourceLine" id="cb73-24" title="24">    p.values2[i,<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(boot.obj2<span class="op">$</span>t<span class="op">&gt;=</span>boot.obj2<span class="op">$</span>t0)</a>
<a class="sourceLine" id="cb73-25" title="25">    p.values2[i,<span class="dv">2</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y2,<span class="dt">R=</span>R,<span class="dt">seed=</span>j<span class="op">*</span>i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb73-26" title="26">  }</a>
<a class="sourceLine" id="cb73-27" title="27">  pow1[j,<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(p.values1[,<span class="dv">1</span>]<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb73-28" title="28">  pow1[j,<span class="dv">2</span>]&lt;-<span class="kw">mean</span>(p.values1[,<span class="dv">2</span>]<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb73-29" title="29">  pow2[j,<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(p.values2[,<span class="dv">1</span>]<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb73-30" title="30">  pow2[j,<span class="dv">2</span>]&lt;-<span class="kw">mean</span>(p.values2[,<span class="dv">2</span>]<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb73-31" title="31">}</a>
<a class="sourceLine" id="cb73-32" title="32"><span class="kw">plot</span>(size,pow1[,<span class="dv">1</span>],<span class="dt">sub=</span><span class="st">&quot;Model1&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;sample size&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;power&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb73-33" title="33"><span class="kw">lines</span>(size,pow1[,<span class="dv">2</span>],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb73-34" title="34"><span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;distance correlation&#39;</span>,<span class="st">&#39;ball covariance&#39;</span>),<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">plot</span>(size,pow2[,<span class="dv">1</span>],<span class="dt">sub=</span><span class="st">&quot;Model2&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;sample size&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;power&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb74-2" title="2"><span class="kw">lines</span>(size,pow2[,<span class="dv">2</span>],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb74-3" title="3"><span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;distance correlation&#39;</span>,<span class="st">&#39;ball covariance&#39;</span>),<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="the-power-value-of-ball-test-in-model-one-is-very-small-almost-0.-the-power-value-of-ball-test-in-model-two-is-always-1.-the-distance-test-of-both-models-changes-with-the-change-of-sample-size-and-the-overall-trend-is-increasing." class="section level4">
<h4>The power value of ball test in model one is very small, almost 0. The power value of ball test in model two is always 1. The distance test of both models changes with the change of sample size, and the overall trend is increasing.</h4>
</div>
<div id="although-the-result-is-not-good-i-have-tried-my-best.-i-really-dont-know-whats-wrong.-i-hope-the-students-who-are-correcting-the-homework-will-be-merciful.-can-help-me-find-out-the-problem-thank-you" class="section level4">
<h4>Although the result is not good, I have tried my best. I really don’t know what’s wrong. I hope the students who are correcting the homework will be merciful. Can help me find out the problem, thank you!</h4>
</div>
</div>
<div id="hw-9" class="section level2">
<h2>HW-9:</h2>
<div id="exercise-9.4-implement-a-random-walk-metropolis-sampler-for-generating-the-standard-laplace-distribution-see-exercise-3.2.-for-the-increment-simulate-from-a-normal-distribution.-compare-the-chains-generated-when-different-variances-are-used-for-the-proposal-distribution.-also-compute-the-acceptance-rates-of-each-chain." class="section level4">
<h4>Exercise 9.4: Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</h4>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">L.d&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb75-2" title="2">  f&lt;-(<span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x)))<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb75-3" title="3">  <span class="kw">return</span>(f)</a>
<a class="sourceLine" id="cb75-4" title="4">}</a>
<a class="sourceLine" id="cb75-5" title="5">L.Metropolis&lt;-<span class="cf">function</span>(sigma,N){</a>
<a class="sourceLine" id="cb75-6" title="6">  x&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb75-7" title="7">  x[<span class="dv">1</span>]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,sigma)</a>
<a class="sourceLine" id="cb75-8" title="8">  u&lt;-<span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb75-9" title="9">  r&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb75-10" title="10">  a&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb75-11" title="11">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb75-12" title="12">    y&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</a>
<a class="sourceLine" id="cb75-13" title="13">    fy&lt;-<span class="kw">L.d</span>(y)</a>
<a class="sourceLine" id="cb75-14" title="14">    fx&lt;-<span class="kw">L.d</span>(x[i<span class="dv">-1</span>])</a>
<a class="sourceLine" id="cb75-15" title="15">    <span class="cf">if</span> (u[i]<span class="op">&lt;=</span>fy<span class="op">/</span>fx){</a>
<a class="sourceLine" id="cb75-16" title="16">      x[i]&lt;-y</a>
<a class="sourceLine" id="cb75-17" title="17">      a&lt;-a<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb75-18" title="18">    }</a>
<a class="sourceLine" id="cb75-19" title="19">    <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb75-20" title="20">      x[i]&lt;-x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb75-21" title="21">      r&lt;-r<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb75-22" title="22">    }</a>
<a class="sourceLine" id="cb75-23" title="23">  }</a>
<a class="sourceLine" id="cb75-24" title="24">  a.rate&lt;-a<span class="op">/</span>N</a>
<a class="sourceLine" id="cb75-25" title="25"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">r=</span>r,<span class="dt">a.rate=</span>a.rate))</a>
<a class="sourceLine" id="cb75-26" title="26">}</a>
<a class="sourceLine" id="cb75-27" title="27"><span class="kw">library</span>(<span class="st">&quot;GeneralizedHyperbolic&quot;</span>)</a>
<a class="sourceLine" id="cb75-28" title="28"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb75-29" title="29">N&lt;-<span class="dv">2000</span></a>
<a class="sourceLine" id="cb75-30" title="30">sigma&lt;-<span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb75-31" title="31">L1&lt;-<span class="kw">L.Metropolis</span>(sigma[<span class="dv">1</span>],N)</a>
<a class="sourceLine" id="cb75-32" title="32">L2&lt;-<span class="kw">L.Metropolis</span>(sigma[<span class="dv">2</span>],N)</a>
<a class="sourceLine" id="cb75-33" title="33">L3&lt;-<span class="kw">L.Metropolis</span>(sigma[<span class="dv">3</span>],N)</a>
<a class="sourceLine" id="cb75-34" title="34">L4&lt;-<span class="kw">L.Metropolis</span>(sigma[<span class="dv">4</span>],N)</a>
<a class="sourceLine" id="cb75-35" title="35"><span class="co">#number of candidate points rejected</span></a>
<a class="sourceLine" id="cb75-36" title="36"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">reject.1=</span>L1<span class="op">$</span>r,<span class="dt">reject.2=</span>L2<span class="op">$</span>r,<span class="dt">reject.3=</span>L3<span class="op">$</span>r,<span class="dt">reject.4=</span>L4<span class="op">$</span>r))</a></code></pre></div>
<pre><code>## reject.1 reject.2 reject.3 reject.4 
##     1427     1694     1755     1841</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co">#acceptance rate</span></a>
<a class="sourceLine" id="cb77-2" title="2"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">acceptance.rate1=</span>L1<span class="op">$</span>a.rate,<span class="dt">acceptance.rate2=</span>L2<span class="op">$</span>a.rate,<span class="dt">acceptance.rate3=</span>L3<span class="op">$</span>a.rate,<span class="dt">acceptance.rate4=</span>L4<span class="op">$</span>a.rate),<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## acceptance.rate1 acceptance.rate2 acceptance.rate3 acceptance.rate4 
##           0.2860           0.1525           0.1220           0.0790</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">refline&lt;-<span class="kw">qskewlap</span>(<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb79-2" title="2">L&lt;-<span class="kw">cbind</span>(L1<span class="op">$</span>x,L2<span class="op">$</span>x,L3<span class="op">$</span>x,L4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb79-3" title="3"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb79-4" title="4">  <span class="kw">plot</span>(L[,j],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma<span class="op">==</span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">ylim=</span><span class="kw">range</span>(L[,j]))</a>
<a class="sourceLine" id="cb79-5" title="5">  <span class="kw">abline</span>(<span class="dt">h=</span>refline)</a>
<a class="sourceLine" id="cb79-6" title="6">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#reset to default</span></a>
<a class="sourceLine" id="cb80-2" title="2"></a>
<a class="sourceLine" id="cb80-3" title="3">p&lt;-<span class="kw">c</span>(.<span class="dv">05</span>,<span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">.9</span>, <span class="fl">.1</span>),.<span class="dv">95</span>)</a>
<a class="sourceLine" id="cb80-4" title="4">Q&lt;-<span class="kw">qskewlap</span>(p)</a>
<a class="sourceLine" id="cb80-5" title="5">L&lt;-<span class="kw">cbind</span>(L1<span class="op">$</span>x,L2<span class="op">$</span>x,L3<span class="op">$</span>x,L4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb80-6" title="6">mc&lt;-L[<span class="dv">501</span><span class="op">:</span>N, ]</a>
<a class="sourceLine" id="cb80-7" title="7">QL&lt;-<span class="kw">apply</span>(mc,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="kw">quantile</span>(x, p))</a>
<a class="sourceLine" id="cb80-8" title="8"></a>
<a class="sourceLine" id="cb80-9" title="9"></a>
<a class="sourceLine" id="cb80-10" title="10">Qc&lt;-<span class="kw">matrix</span>(<span class="kw">round</span>(<span class="kw">cbind</span>(Q,QL),<span class="dv">3</span>),<span class="dt">nrow=</span><span class="dv">11</span>,<span class="dt">ncol=</span><span class="dv">5</span>,<span class="dt">dimnames=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;5%&quot;</span>,<span class="st">&quot;10%&quot;</span>,<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;30%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;50%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;70%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;90%&quot;</span>,<span class="st">&quot;95%&quot;</span>),<span class="kw">c</span>(<span class="st">&quot;origin&quot;</span>,<span class="st">&quot;5&quot;</span>,<span class="st">&quot;10&quot;</span>,<span class="st">&quot;15&quot;</span>,<span class="st">&quot;20&quot;</span>)))</a>
<a class="sourceLine" id="cb80-11" title="11">knitr<span class="op">::</span><span class="kw">kable</span>(Qc,<span class="dt">format=</span><span class="st">&quot;markdown&quot;</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">origin</th>
<th align="right">5</th>
<th align="right">10</th>
<th align="right">15</th>
<th align="right">20</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">5%</td>
<td align="right">-2.303</td>
<td align="right">-2.300</td>
<td align="right">-2.384</td>
<td align="right">-2.292</td>
<td align="right">-1.696</td>
</tr>
<tr class="even">
<td align="left">10%</td>
<td align="right">-1.609</td>
<td align="right">-1.639</td>
<td align="right">-1.771</td>
<td align="right">-1.659</td>
<td align="right">-1.141</td>
</tr>
<tr class="odd">
<td align="left">20%</td>
<td align="right">-0.916</td>
<td align="right">-0.941</td>
<td align="right">-1.142</td>
<td align="right">-0.941</td>
<td align="right">-0.900</td>
</tr>
<tr class="even">
<td align="left">30%</td>
<td align="right">-0.511</td>
<td align="right">-0.500</td>
<td align="right">-0.709</td>
<td align="right">-0.655</td>
<td align="right">-0.473</td>
</tr>
<tr class="odd">
<td align="left">40%</td>
<td align="right">-0.223</td>
<td align="right">-0.220</td>
<td align="right">-0.346</td>
<td align="right">-0.464</td>
<td align="right">-0.214</td>
</tr>
<tr class="even">
<td align="left">50%</td>
<td align="right">0.000</td>
<td align="right">0.031</td>
<td align="right">-0.186</td>
<td align="right">-0.050</td>
<td align="right">-0.041</td>
</tr>
<tr class="odd">
<td align="left">60%</td>
<td align="right">0.223</td>
<td align="right">0.240</td>
<td align="right">0.011</td>
<td align="right">0.181</td>
<td align="right">0.156</td>
</tr>
<tr class="even">
<td align="left">70%</td>
<td align="right">0.511</td>
<td align="right">0.496</td>
<td align="right">0.270</td>
<td align="right">0.395</td>
<td align="right">0.294</td>
</tr>
<tr class="odd">
<td align="left">80%</td>
<td align="right">0.916</td>
<td align="right">0.918</td>
<td align="right">0.779</td>
<td align="right">1.083</td>
<td align="right">0.585</td>
</tr>
<tr class="even">
<td align="left">90%</td>
<td align="right">1.609</td>
<td align="right">1.511</td>
<td align="right">1.526</td>
<td align="right">2.085</td>
<td align="right">1.528</td>
</tr>
<tr class="odd">
<td align="left">95%</td>
<td align="right">2.303</td>
<td align="right">2.419</td>
<td align="right">2.298</td>
<td align="right">2.826</td>
<td align="right">2.003</td>
</tr>
</tbody>
</table>
</div>
<div id="judging-from-the-acceptance-rate-the-conditions-are-satisfied-when-the-variance-is-5-and-10-and-the-larger-the-variance-load-the-lower-the-acceptance-rate.-from-the-image-the-performance-is-best-when-the-variance-is-15.-from-the-quantile-point-of-view-when-the-variance-is-5-it-is-closest-to-the-original-quantile.-in-summary-it-can-be-seen-that-the-variance-changes-have-a-greater-impact-on-the-results." class="section level4">
<h4>Judging from the acceptance rate, the conditions are satisfied when the variance is 5 and 10, and the larger the variance load, the lower the acceptance rate. From the image, the performance is best when the variance is 15. From the quantile point of view, when the variance is 5, it is closest to the original quantile. In summary, it can be seen that the variance changes have a greater impact on the results.</h4>
</div>
</div>
<div id="hw-10" class="section level2">
<h2>HW-10:</h2>
<div id="exercise-11.1" class="section level3">
<h3>Exercise 11.1</h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">x&lt;-<span class="fl">0.1</span></a>
<a class="sourceLine" id="cb81-2" title="2"><span class="kw">isTRUE</span>(<span class="kw">log</span>(<span class="kw">exp</span>(x))<span class="op">==</span><span class="kw">exp</span>(<span class="kw">log</span>(x)))</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">log</span>(<span class="kw">exp</span>(x)),<span class="kw">exp</span>(<span class="kw">log</span>(x))))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">identical</span>(<span class="kw">log</span>(<span class="kw">exp</span>(x)),<span class="kw">exp</span>(<span class="kw">log</span>(x)))</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div id="the-identity-does-not-hold-with-near-equality." class="section level4">
<h4>The identity does not hold with near equality.</h4>
</div>
</div>
<div id="exercise-11.5" class="section level3">
<h3>Exercise 11.5</h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">f&lt;-<span class="cf">function</span>(k,a){</a>
<a class="sourceLine" id="cb87-2" title="2">  ck&lt;-<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb87-3" title="3">  f1&lt;-<span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb87-4" title="4">  f2&lt;-<span class="cf">function</span>(u){</a>
<a class="sourceLine" id="cb87-5" title="5">    (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb87-6" title="6">  }</a>
<a class="sourceLine" id="cb87-7" title="7">  inte&lt;-<span class="kw">integrate</span>(f2,<span class="dt">lower=</span><span class="dv">0</span>,<span class="dt">upper=</span>ck,<span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb87-8" title="8">  <span class="kw">return</span>(f1<span class="op">*</span>inte<span class="op">$</span>value)</a>
<a class="sourceLine" id="cb87-9" title="9">}</a>
<a class="sourceLine" id="cb87-10" title="10">findroot&lt;-<span class="cf">function</span>(k){</a>
<a class="sourceLine" id="cb87-11" title="11">  a&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">sqrt</span>(k),<span class="dt">length.out=</span><span class="dv">50</span><span class="op">*</span>k)</a>
<a class="sourceLine" id="cb87-12" title="12">  n&lt;-<span class="kw">length</span>(a)</a>
<a class="sourceLine" id="cb87-13" title="13">  b&lt;-<span class="kw">numeric</span>(n<span class="dv">-2</span>)</a>
<a class="sourceLine" id="cb87-14" title="14">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>(n<span class="dv">-1</span>)){</a>
<a class="sourceLine" id="cb87-15" title="15">    b[i]&lt;-<span class="kw">abs</span>(<span class="kw">f</span>(k<span class="dv">-1</span>,a[i])<span class="op">-</span><span class="kw">f</span>(k,a[i]))</a>
<a class="sourceLine" id="cb87-16" title="16">  }</a>
<a class="sourceLine" id="cb87-17" title="17">  <span class="cf">if</span>(<span class="kw">min</span>(b)<span class="op">&lt;=</span><span class="fl">0.001</span>){</a>
<a class="sourceLine" id="cb87-18" title="18">    i&lt;-<span class="kw">which</span>(b<span class="op">==</span><span class="kw">min</span>(b),<span class="dt">arr.ind=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb87-19" title="19">    <span class="kw">return</span>(a[i<span class="op">+</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb87-20" title="20">  }</a>
<a class="sourceLine" id="cb87-21" title="21">  <span class="cf">else</span> <span class="kw">return</span>(a[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb87-22" title="22">}</a>
<a class="sourceLine" id="cb87-23" title="23">k&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb87-24" title="24">N&lt;-<span class="kw">length</span>(k)</a>
<a class="sourceLine" id="cb87-25" title="25">a.root&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb87-26" title="26"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb87-27" title="27">  a.root[j]&lt;-<span class="kw">findroot</span>(k[j])</a>
<a class="sourceLine" id="cb87-28" title="28">}</a>
<a class="sourceLine" id="cb87-29" title="29">a.root</a></code></pre></div>
<pre><code>##  [1] 0.010050251 0.008980193 0.008192273 0.007580949 0.007088790
##  [6] 0.006681514 0.006337230 0.006041211 0.005783141 0.005555549
## [11] 0.005352872 0.005170872 0.005006258 0.004856426 0.004719289
## [16] 0.004593150 0.004476613 0.004368518 0.004267894 0.004173918
## [21] 0.004085888 0.004003203 0.002000400</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="co">#points A(k) in 11.4</span></a>
<a class="sourceLine" id="cb89-2" title="2">s&lt;-<span class="cf">function</span>(k,a){</a>
<a class="sourceLine" id="cb89-3" title="3">  ck&lt;-<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb89-4" title="4">  <span class="kw">return</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(ck,k))</a>
<a class="sourceLine" id="cb89-5" title="5">}</a>
<a class="sourceLine" id="cb89-6" title="6">sroot&lt;-<span class="cf">function</span>(k){</a>
<a class="sourceLine" id="cb89-7" title="7">  a&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">sqrt</span>(k),<span class="dt">length.out=</span><span class="dv">50</span><span class="op">*</span>k)</a>
<a class="sourceLine" id="cb89-8" title="8">  n&lt;-<span class="kw">length</span>(a)</a>
<a class="sourceLine" id="cb89-9" title="9">  b&lt;-<span class="kw">numeric</span>(n<span class="dv">-2</span>)</a>
<a class="sourceLine" id="cb89-10" title="10">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>(n<span class="dv">-1</span>)){</a>
<a class="sourceLine" id="cb89-11" title="11">    b[i]&lt;-<span class="kw">abs</span>(<span class="kw">s</span>(k<span class="dv">-1</span>,a[i])<span class="op">-</span><span class="kw">s</span>(k,a[i]))</a>
<a class="sourceLine" id="cb89-12" title="12">  }</a>
<a class="sourceLine" id="cb89-13" title="13">  <span class="cf">if</span>(<span class="kw">min</span>(b)<span class="op">&lt;=</span><span class="fl">0.001</span>){</a>
<a class="sourceLine" id="cb89-14" title="14">    i&lt;-<span class="kw">which</span>(b<span class="op">==</span><span class="kw">min</span>(b),<span class="dt">arr.ind=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb89-15" title="15">    <span class="kw">return</span>(a[i<span class="op">+</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb89-16" title="16">  }</a>
<a class="sourceLine" id="cb89-17" title="17">  <span class="cf">else</span> <span class="kw">return</span>(a[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb89-18" title="18">}</a>
<a class="sourceLine" id="cb89-19" title="19">s.root&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb89-20" title="20">j&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb89-21" title="21"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb89-22" title="22">  s.root[j]&lt;-<span class="kw">sroot</span>(k[j])</a>
<a class="sourceLine" id="cb89-23" title="23">}</a></code></pre></div>
<pre><code>## Warning in s.root[j] &lt;- sroot(k[j]): 被替换的项目不是替换值长度的倍数

## Warning in s.root[j] &lt;- sroot(k[j]): 被替换的项目不是替换值长度的倍数

## Warning in s.root[j] &lt;- sroot(k[j]): 被替换的项目不是替换值长度的倍数

## Warning in s.root[j] &lt;- sroot(k[j]): 被替换的项目不是替换值长度的倍数</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">s.root</a></code></pre></div>
<pre><code>##  [1] 0.010050251 0.008980193 0.008192273 0.007580949 0.007088790
##  [6] 0.006681514 0.006337230 0.006041211 0.005783141 0.005555549
## [11] 0.005352872 0.005170872 0.005006258 0.004856426 0.004719289
## [16] 0.004593150 0.004476613 0.004368518 0.004267894 0.004173918
## [21] 0.004085888 0.004003203 0.002000400</code></pre>
<div id="there-is-no-difference-between-the-solutions-with-the-points-ak-in-exercise-11.4." class="section level4">
<h4>There is no difference between the solutions with the points A(k) in exercise 11.4.</h4>
</div>
<div id="a-b-o-blood-type-problem" class="section level4">
<h4>A-B-O blood type problem</h4>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw">library</span>(nloptr)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;nloptr&#39;是用R版本3.6.2 来建造的</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="co"># Mle </span></a>
<a class="sourceLine" id="cb95-2" title="2">eval_f0 =<span class="st"> </span><span class="cf">function</span>(x,x1,<span class="dt">n.A=</span><span class="dv">28</span>,<span class="dt">n.B=</span><span class="dv">24</span>,<span class="dt">nOO=</span><span class="dv">41</span>,<span class="dt">nAB=</span><span class="dv">70</span>) {</a>
<a class="sourceLine" id="cb95-3" title="3">  </a>
<a class="sourceLine" id="cb95-4" title="4">  r1 =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x1)</a>
<a class="sourceLine" id="cb95-5" title="5">  nAA =<span class="st"> </span>n.A<span class="op">*</span>x1[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x1[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x1[<span class="dv">1</span>]<span class="op">*</span>r1)</a>
<a class="sourceLine" id="cb95-6" title="6">  nBB =<span class="st"> </span>n.B<span class="op">*</span>x1[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x1[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x1[<span class="dv">2</span>]<span class="op">*</span>r1)</a>
<a class="sourceLine" id="cb95-7" title="7">  r =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb95-8" title="8">  <span class="kw">return</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nAA<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">1</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nBB<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">-</span></a>
<a class="sourceLine" id="cb95-9" title="9"><span class="st">           </span>(n.A<span class="op">-</span>nAA)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>r)<span class="op">-</span>(n.B<span class="op">-</span>nBB)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>r)<span class="op">-</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>x[<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb95-10" title="10">}</a>
<a class="sourceLine" id="cb95-11" title="11"></a>
<a class="sourceLine" id="cb95-12" title="12"></a>
<a class="sourceLine" id="cb95-13" title="13"><span class="co"># constraint</span></a>
<a class="sourceLine" id="cb95-14" title="14">eval_g0 =<span class="st"> </span><span class="cf">function</span>(x,x1,<span class="dt">n.A=</span><span class="dv">28</span>,<span class="dt">n.B=</span><span class="dv">24</span>,<span class="dt">nOO=</span><span class="dv">41</span>,<span class="dt">nAB=</span><span class="dv">70</span>) {</a>
<a class="sourceLine" id="cb95-15" title="15">  <span class="kw">return</span>(<span class="kw">sum</span>(x)<span class="op">-</span><span class="fl">0.999999</span>)</a>
<a class="sourceLine" id="cb95-16" title="16">}</a>
<a class="sourceLine" id="cb95-17" title="17"></a>
<a class="sourceLine" id="cb95-18" title="18">opts =<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;algorithm&quot;</span>=<span class="st">&quot;NLOPT_LN_COBYLA&quot;</span>,</a>
<a class="sourceLine" id="cb95-19" title="19">             <span class="st">&quot;xtol_rel&quot;</span>=<span class="fl">1.0e-8</span>)</a>
<a class="sourceLine" id="cb95-20" title="20">mle =<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb95-21" title="21">r =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb95-22" title="22">r =<span class="st"> </span><span class="kw">rbind</span>(r,<span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.35</span>))<span class="co"># the beginning value of p0 and q0</span></a>
<a class="sourceLine" id="cb95-23" title="23">j =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb95-24" title="24"><span class="cf">while</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(r[j,]<span class="op">-</span>r[j<span class="dv">-1</span>,]))<span class="op">&gt;</span><span class="fl">1e-8</span>) {</a>
<a class="sourceLine" id="cb95-25" title="25">res =<span class="st"> </span><span class="kw">nloptr</span>( <span class="dt">x0=</span><span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.25</span>),</a>
<a class="sourceLine" id="cb95-26" title="26">               <span class="dt">eval_f=</span>eval_f0,</a>
<a class="sourceLine" id="cb95-27" title="27">               <span class="dt">lb =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">ub =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb95-28" title="28">               <span class="dt">eval_g_ineq =</span> eval_g0, </a>
<a class="sourceLine" id="cb95-29" title="29">               <span class="dt">opts =</span> opts, <span class="dt">x1=</span>r[j,],<span class="dt">n.A=</span><span class="dv">28</span>,<span class="dt">n.B=</span><span class="dv">24</span>,<span class="dt">nOO=</span><span class="dv">41</span>,<span class="dt">nAB=</span><span class="dv">70</span> )</a>
<a class="sourceLine" id="cb95-30" title="30">j =<span class="st"> </span>j<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb95-31" title="31">r =<span class="st"> </span><span class="kw">rbind</span>(r,res<span class="op">$</span>solution)</a>
<a class="sourceLine" id="cb95-32" title="32">mle =<span class="st"> </span><span class="kw">c</span>(mle,<span class="kw">eval_f0</span>(<span class="dt">x=</span>r[j,],<span class="dt">x1=</span>r[j<span class="dv">-1</span>,]))</a>
<a class="sourceLine" id="cb95-33" title="33">}</a>
<a class="sourceLine" id="cb95-34" title="34"><span class="co">#the result of EM algorithm</span></a>
<a class="sourceLine" id="cb95-35" title="35">r </a></code></pre></div>
<pre><code>##            [,1]      [,2]
##  [1,] 0.0000000 0.0000000
##  [2,] 0.2000000 0.3500000
##  [3,] 0.3162298 0.3089571
##  [4,] 0.3260961 0.3098301
##  [5,] 0.3271807 0.3103186
##  [6,] 0.3273212 0.3104097
##  [7,] 0.3273409 0.3104241
##  [8,] 0.3273438 0.3104263
##  [9,] 0.3273442 0.3104266
## [10,] 0.3273442 0.3104267
## [11,] 0.3273442 0.3104267
## [12,] 0.3273442 0.3104267</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="co">#the max likelihood values</span></a>
<a class="sourceLine" id="cb97-2" title="2"><span class="kw">plot</span>(mle,<span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw-11" class="section level2">
<h2>HW-11:</h2>
####
<span class="math display">\[\begin{array}{l}{\text { 3. Use both for loops and lapply() to fit linear models to the }} \\ {\text { mtcars using the formulas stored in this list: }} \\ {\text { formulas &lt;- listl }} \\ {\text { mpg - disp, }} \\ {\text { mpg - I(1 \prime &#39;disp), }} \\ {\text { mpg - disp + wt, }} \\ {\text { &quot;mpg - I(1 / disp) + wt }}\end{array}\]</span>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">formulas&lt;-<span class="kw">list</span>(mpg<span class="op">~</span>disp,mpg<span class="op">~</span><span class="kw">I</span>(<span class="dv">1</span><span class="op">/</span>disp),mpg<span class="op">~</span>disp<span class="op">+</span>wt,mpg<span class="op">~</span><span class="kw">I</span>(<span class="dv">1</span><span class="op">/</span>disp)<span class="op">+</span>wt)</a>
<a class="sourceLine" id="cb98-2" title="2">fun&lt;-<span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb98-3" title="3">  <span class="kw">lm</span>(formulas[[i]],<span class="dt">data=</span>mtcars)</a>
<a class="sourceLine" id="cb98-4" title="4">}</a>
<a class="sourceLine" id="cb98-5" title="5"><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,fun)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">lm&lt;-<span class="kw">list</span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb100-2" title="2"><span class="kw">length</span>(lm)&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb100-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb100-4" title="4">  lm[[i]]&lt;-<span class="kw">fun</span>(i)</a>
<a class="sourceLine" id="cb100-5" title="5">}</a>
<a class="sourceLine" id="cb100-6" title="6">lm</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div id="we-find-the-results-of-lapply-are-same-with-the-results-of-loops." class="section level4">
<h4>We find the results of lapply() are same with the results of loops.</h4>
####
<span class="math display">\[\begin{array}{l}{\text { 4. Fit the model mog - disp to each of the bootstrap replicates }} \\ {\text { of mtcars in the list below by using a for loop and lapply (). }} \\ {\text { Can you do it without an anonymous function? }} \\ {\text { bootstraps }&lt;-1 \text { apply }(1: 1 \theta, \text { function (i) } £} \\ {\text { mows }&lt;-\text { sample }(1: \text { nrow(mtcars), rep }=\text { TRUE })} \\ {\text { 3) }}\end{array}\]</span>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">boot&lt;-<span class="cf">function</span>(x) x[<span class="kw">sample</span>(<span class="kw">nrow</span>(x),<span class="dt">replace=</span><span class="ot">TRUE</span>),]</a>
<a class="sourceLine" id="cb102-2" title="2">boot_lm&lt;-<span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb102-3" title="3">  dat&lt;-<span class="kw">boot</span>(mtcars)</a>
<a class="sourceLine" id="cb102-4" title="4">  <span class="kw">lm</span>(mpg<span class="op">~</span>disp,<span class="dt">data=</span>dat)</a>
<a class="sourceLine" id="cb102-5" title="5">}</a>
<a class="sourceLine" id="cb102-6" title="6"><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,boot_lm)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    27.04354     -0.03356  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    28.89343     -0.03604  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    30.39959     -0.04616  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    28.07849     -0.03258  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    30.39452     -0.04636  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    31.78853     -0.05197  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    29.94150     -0.04244  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    27.85986     -0.03424  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    28.13801     -0.03619  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    31.43950     -0.04328</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1">b&lt;-<span class="kw">list</span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb104-2" title="2"><span class="kw">length</span>(b)&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb104-3" title="3"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb104-4" title="4">  b[[j]]&lt;-<span class="kw">boot_lm</span>(j)</a>
<a class="sourceLine" id="cb104-5" title="5">}</a>
<a class="sourceLine" id="cb104-6" title="6">b</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    30.51785     -0.04491  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    29.68553     -0.04118  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    27.94343     -0.03382  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    31.03424     -0.04423  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##     28.9713      -0.0379  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    27.99902     -0.03835  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    27.89409     -0.03633  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    27.99125     -0.03795  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##    28.18801     -0.03735  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = dat)
## 
## Coefficients:
## (Intercept)         disp  
##     28.7383      -0.0392</code></pre>
</div>
<div id="we-find-the-results-of-lapply-are-same-with-the-results-of-loops.-1" class="section level4">
<h4>We find the results of lapply() are same with the results of loops.</h4>
####
<span class="math display">\[\begin{array}{l}{\text { 5. For each model in the previous two exercises, extract } R^{2} \text { using }} \\ {\text { the function below. }} \\ {\text { rsq }&lt;\text { - function (mod) sumary (mod) } \$ \text { r. squared }}\end{array}\]</span>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">rsq&lt;-<span class="cf">function</span>(i) <span class="kw">summary</span>(<span class="kw">fun</span>(i))<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb106-2" title="2"><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1">boot_rsq&lt;-<span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb108-2" title="2">  <span class="kw">summary</span>(<span class="kw">boot_lm</span>(i))<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb108-3" title="3">}</a>
<a class="sourceLine" id="cb108-4" title="4"><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,boot_rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7635986
## 
## [[2]]
## [1] 0.7802576
## 
## [[3]]
## [1] 0.7348501
## 
## [[4]]
## [1] 0.7164578
## 
## [[5]]
## [1] 0.7428305
## 
## [[6]]
## [1] 0.7033184
## 
## [[7]]
## [1] 0.6739633
## 
## [[8]]
## [1] 0.7013801
## 
## [[9]]
## [1] 0.7310196
## 
## [[10]]
## [1] 0.7602624</code></pre>
####
<span class="math display">\[\begin{array}{l}{\text { 3. The following code simulates the performance of a t-test for }} \\ {\text { non-normal data. Use sapply() and an anonymous function }} \\ {\text { to extract the p-value from every trial. }} \\ {\text { trials }&lt;-\text { replicater }} \\ { \text { t.test(rpois }(10,10), \text { rpois(7, } 10))} \\ {\text { Extra challenge: get rid of the anonymous function by using }} \\ {\text { I: directly. }}\end{array}\]</span>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1">trials&lt;-<span class="kw">replicate</span>(<span class="dv">100</span>,<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>,<span class="dv">10</span>),<span class="kw">rpois</span>(<span class="dv">7</span>,<span class="dv">10</span>)),<span class="dt">simplify=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb110-2" title="2">p&lt;-<span class="cf">function</span>(i) trials[[i]]<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb110-3" title="3"><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,p)</a></code></pre></div>
<pre><code>##   [1] 0.96771107 0.93530887 0.79933650 0.32049383 0.63930895 0.50144785
##   [7] 0.47416893 0.94734442 0.80809124 0.64536049 0.21717677 0.14386179
##  [13] 0.38815934 0.74565094 0.38893472 0.03193888 0.84928758 0.09267732
##  [19] 1.00000000 0.98546044 0.14694742 0.69823218 0.93510288 0.48529568
##  [25] 0.89108545 0.47649092 0.68913753 0.39839397 0.22208839 0.34596609
##  [31] 0.66995770 0.26190057 0.79377952 0.36294917 0.10346800 0.83554416
##  [37] 0.96348321 0.55808678 0.15038132 0.69378223 0.83178558 0.28326050
##  [43] 0.17345956 0.18456838 0.22872806 0.95967859 0.69321529 0.40517731
##  [49] 0.62344777 0.53678958 0.97030522 0.15515085 0.87116063 0.48181433
##  [55] 0.53513914 0.65677152 0.43747133 0.30293741 0.65065396 0.61840931
##  [61] 0.75148567 0.55457607 0.81194810 0.85369042 0.97560066 0.17934925
##  [67] 0.49566084 0.39929428 0.61938166 0.81712877 0.52724026 0.41476662
##  [73] 0.50249784 0.51137699 0.29377546 0.93708622 0.36407856 0.52196272
##  [79] 0.84433091 0.77050556 0.76011688 0.13038435 0.61573233 0.47746908
##  [85] 0.04008025 0.77211574 0.07755771 0.24375595 0.19792885 0.67957621
##  [91] 0.04499309 0.74147709 0.42002509 1.00000000 0.78909699 0.20893392
##  [97] 0.29352079 0.70490912 0.18363736 0.86545194</code></pre>
####
<span class="math display">\[\begin{array}{l}{\text { 7. Implement mesapply(), a multicore version of sapply(). Can }} \\ {\text { you implement mcvapply(), a parallel version of vapply(O? }} \\ {\text { Why or why not? }}\end{array}\]</span>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb112-2" title="2">boot.rsq&lt;-<span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb112-3" title="3">  dat&lt;-mtcars[<span class="kw">sample</span>(<span class="kw">nrow</span>(mtcars),<span class="dt">replace=</span><span class="ot">TRUE</span>),]</a>
<a class="sourceLine" id="cb112-4" title="4">  lm&lt;-<span class="kw">lm</span>(mpg<span class="op">~</span>disp,<span class="dt">data=</span>dat)</a>
<a class="sourceLine" id="cb112-5" title="5">  <span class="kw">summary</span>(lm)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb112-6" title="6">}</a>
<a class="sourceLine" id="cb112-7" title="7">no_cores&lt;-<span class="dv">7</span></a>
<a class="sourceLine" id="cb112-8" title="8">cl&lt;-<span class="kw">makeCluster</span>(no_cores)</a>
<a class="sourceLine" id="cb112-9" title="9"><span class="kw">system.time</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,boot.rsq))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.08 0.00 0.07</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="kw">system.time</span>(<span class="kw">parSapply</span>(cl,<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,boot.rsq))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.00 0.00 0.03</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="kw">system.time</span>(<span class="kw">vapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,boot.rsq,<span class="dv">0</span>))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
##  0.1  0.0  0.1</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="kw">stopCluster</span>(cl)</a></code></pre></div>
</div>
<div id="we-found-that-parsapply-saves-time-compared-to-sapply.-but-windows-system-cannot-use-mcvapply.-i-also-had-problems-using-the-teachers-method-and-i-planned-to-ask-the-teacher-in-class." class="section level4">
<h4>We found that parSapply saves time compared to sapply. But windows system cannot use mcvapply. I also had problems using the teacher’s method, and I planned to ask the teacher in class.</h4>
</div>
</div>
<div id="hw-12" class="section level2">
<h2>HW-12:</h2>
<p>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R). Rewrite an Rcpp function for the same task. Compare the generated random numbers by the two functions using qqplot. Campare the computation time of the two functions with microbenchmark. Comments your results.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb119-2" title="2"></a>
<a class="sourceLine" id="cb119-3" title="3"><span class="co">#the function using R</span></a>
<a class="sourceLine" id="cb119-4" title="4">lap_f =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb119-5" title="5"></a>
<a class="sourceLine" id="cb119-6" title="6">rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</a>
<a class="sourceLine" id="cb119-7" title="7"> x =<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb119-8" title="8"> x[<span class="dv">1</span>] =<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb119-9" title="9"> u =<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb119-10" title="10"> k =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb119-11" title="11"> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb119-12" title="12">  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb119-13" title="13">  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap_f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap_f</span>(x[i<span class="dv">-1</span>]))) x[i] =<span class="st"> </span>y </a>
<a class="sourceLine" id="cb119-14" title="14">  <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb119-15" title="15">  x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb119-16" title="16">  k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb119-17" title="17">  }</a>
<a class="sourceLine" id="cb119-18" title="18"> }</a>
<a class="sourceLine" id="cb119-19" title="19"> <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</a>
<a class="sourceLine" id="cb119-20" title="20">}</a>
<a class="sourceLine" id="cb119-21" title="21"></a>
<a class="sourceLine" id="cb119-22" title="22"><span class="co">#the function using Rcpp</span></a>
<a class="sourceLine" id="cb119-23" title="23"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb119-24" title="24"><span class="kw">cppFunction</span>(<span class="st">&#39;NumericVector cpp_Metropolis(double sigma, double x0, int N){</span></a>
<a class="sourceLine" id="cb119-25" title="25"><span class="st">NumericVector x(N);</span></a>
<a class="sourceLine" id="cb119-26" title="26"><span class="st">x[0]=x0;</span></a>
<a class="sourceLine" id="cb119-27" title="27"><span class="st">for (int i=1;i&lt;N;i++) {</span></a>
<a class="sourceLine" id="cb119-28" title="28"><span class="st">double e=runif(1)[0];</span></a>
<a class="sourceLine" id="cb119-29" title="29"><span class="st">double z=rnorm(1,x[i-1],sigma)[0];</span></a>
<a class="sourceLine" id="cb119-30" title="30"><span class="st">if (e&lt;=exp(abs(x[i-1])-abs(z))) x[i]=z;</span></a>
<a class="sourceLine" id="cb119-31" title="31"><span class="st">else {</span></a>
<a class="sourceLine" id="cb119-32" title="32"><span class="st">x[i]=x[i-1];</span></a>
<a class="sourceLine" id="cb119-33" title="33"><span class="st">}</span></a>
<a class="sourceLine" id="cb119-34" title="34"><span class="st">}</span></a>
<a class="sourceLine" id="cb119-35" title="35"><span class="st">return x;</span></a>
<a class="sourceLine" id="cb119-36" title="36"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb119-37" title="37"></a>
<a class="sourceLine" id="cb119-38" title="38"><span class="co">#generate random numbers</span></a>
<a class="sourceLine" id="cb119-39" title="39">N&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb119-40" title="40">sigma&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb119-41" title="41">x0&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb119-42" title="42">R&lt;-<span class="kw">rw.Metropolis</span>(sigma,x0,N)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb119-43" title="43">cpp&lt;-<span class="kw">cpp_Metropolis</span>(sigma,x0,N)</a>
<a class="sourceLine" id="cb119-44" title="44"></a>
<a class="sourceLine" id="cb119-45" title="45"><span class="co">#qqplot</span></a>
<a class="sourceLine" id="cb119-46" title="46"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb119-47" title="47"><span class="kw">qqnorm</span>(R)</a>
<a class="sourceLine" id="cb119-48" title="48"><span class="kw">qqline</span>(R)</a>
<a class="sourceLine" id="cb119-49" title="49"><span class="kw">qqnorm</span>(cpp,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb119-50" title="50"><span class="kw">qqline</span>(cpp,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="co">#computation time</span></a>
<a class="sourceLine" id="cb120-2" title="2"><span class="kw">library</span>(microbenchmark)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本3.6.2 来建造的</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1">time&lt;-<span class="kw">microbenchmark</span>(<span class="dt">R=</span><span class="kw">rw.Metropolis</span>(sigma,x0,N),<span class="dt">Rcpp=</span><span class="kw">cpp_Metropolis</span>(sigma,x0,N))</a>
<a class="sourceLine" id="cb122-2" title="2"><span class="kw">summary</span>(time)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr      lq  median     uq
## 1    R 2572.10 2621.10 2644.6
## 2 Rcpp  136.45  138.45  140.3</code></pre>
<p>The qq plot of Rcpp data is closer to the diagonal, and the results are more consistent with the original data. And use Rcpp operation to save time.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
