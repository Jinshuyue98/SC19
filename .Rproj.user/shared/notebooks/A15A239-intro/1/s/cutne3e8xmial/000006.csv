"0","library(Rcpp)"
"0","cppFunction('NumericVector Metropolis(double sigma, double x0, int N){"
"0","  NumericVector x(N);"
"0","  x[0]=x0;"
"0","  for (int i=1;i<N;i++) {"
"0","    double e=runif(1)[0];"
"0","    double z=rnorm(1,x[i-1],sigma)[0];"
"0","    if (e<=exp(abs(x[i-1])-abs(z))) x[i]=z;"
"0","    else {"
"0","      x[i]=x[i-1];"
"0","    }"
"0","  }"
"0","  return x;"
"0","}')"
